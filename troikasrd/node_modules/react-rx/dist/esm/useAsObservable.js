import { BehaviorSubject } from 'rxjs';
import { useRef } from 'react';
import { useIsomorphicEffect } from './useIsomorphicEffect';
export function useAsObservable(value, operator) {
    var isInitial = useRef(true);
    var subjectRef = useRef(new BehaviorSubject(value));
    var observableRef = useRef();
    if (!observableRef.current) {
        var observable = subjectRef.current.asObservable();
        observableRef.current = operator ? observable.pipe(operator) : observable;
    }
    useIsomorphicEffect(function () {
        if (isInitial.current) {
            isInitial.current = false;
        }
        else {
            // emit only on update
            subjectRef.current.next(value);
        }
    }, [value]);
    useIsomorphicEffect(function () {
        return function () {
            return subjectRef.current.complete();
        };
    }, []);
    return observableRef.current;
}
