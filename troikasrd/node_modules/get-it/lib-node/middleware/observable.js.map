{"version":3,"sources":["../../src/middleware/observable.js"],"names":["global","require","objectAssign","module","exports","opts","Observable","implementation","Error","onReturn","channels","context","observer","error","subscribe","err","progress","event","next","type","response","complete","request","publish","abort"],"mappings":";;AAAA,MAAMA,SAASC,QAAQ,gBAAR,CAAf;AACA,MAAMC,eAAeD,QAAQ,eAAR,CAArB;;AAEAE,OAAOC,OAAP,GAAiB,YAAe;AAAA,MAAdC,IAAc,uEAAP,EAAO;;AAC9B,QAAMC,aAAaD,KAAKE,cAAL,IAAuBP,OAAOM,UAAjD;AACA,MAAI,CAACA,UAAL,EAAiB;AACf,UAAM,IAAIE,KAAJ,CACJ,iFADI,CAAN;AAGD;;AAED,SAAO;AACLC,cAAU,CAACC,QAAD,EAAWC,OAAX,KACR,IAAIL,UAAJ,CAAeM,YAAY;AACzBF,eAASG,KAAT,CAAeC,SAAf,CAAyBC,OAAOH,SAASC,KAAT,CAAeE,GAAf,CAAhC;AACAL,eAASM,QAAT,CAAkBF,SAAlB,CAA4BG,SAASL,SAASM,IAAT,CAAchB,aAAa,EAACiB,MAAM,UAAP,EAAb,EAAiCF,KAAjC,CAAd,CAArC;AACAP,eAASU,QAAT,CAAkBN,SAAlB,CAA4BM,YAAY;AACtCR,iBAASM,IAAT,CAAchB,aAAa,EAACiB,MAAM,UAAP,EAAb,EAAiCC,QAAjC,CAAd;AACAR,iBAASS,QAAT;AACD,OAHD;;AAKAX,eAASY,OAAT,CAAiBC,OAAjB,CAAyBZ,OAAzB;AACA,aAAO,MAAMD,SAASc,KAAT,CAAeD,OAAf,EAAb;AACD,KAVD;AAFG,GAAP;AAcD,CAtBD","file":"observable.js","sourcesContent":["const global = require('../util/global')\nconst objectAssign = require('object-assign')\n\nmodule.exports = (opts = {}) => {\n  const Observable = opts.implementation || global.Observable\n  if (!Observable) {\n    throw new Error(\n      '`Observable` is not available in global scope, and no implementation was passed'\n    )\n  }\n\n  return {\n    onReturn: (channels, context) =>\n      new Observable(observer => {\n        channels.error.subscribe(err => observer.error(err))\n        channels.progress.subscribe(event => observer.next(objectAssign({type: 'progress'}, event)))\n        channels.response.subscribe(response => {\n          observer.next(objectAssign({type: 'response'}, response))\n          observer.complete()\n        })\n\n        channels.request.publish(context)\n        return () => channels.abort.publish()\n      })\n  }\n}\n"]}