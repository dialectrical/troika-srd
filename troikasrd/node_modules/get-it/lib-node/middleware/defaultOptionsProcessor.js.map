{"version":3,"sources":["../../src/middleware/defaultOptionsProcessor.js"],"names":["objectAssign","require","urlParse","isReactNative","navigator","product","has","Object","prototype","hasOwnProperty","defaultOptions","timeout","module","exports","opts","options","url","normalizeTimeout","query","removeUndefined","method","body","toUpperCase","toString","stringifyQueryString","obj","pairs","key","call","push","length","join","val","Array","isArray","forEach","item","map","encodeURIComponent","time","connect","socket","delay","Number","isNaN","target","undefined"],"mappings":"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","file":"defaultOptionsProcessor.js","sourcesContent":["const objectAssign = require('object-assign')\nconst urlParse = require('url-parse')\n\nconst isReactNative = typeof navigator === 'undefined' ? false : navigator.product === 'ReactNative'\n\nconst has = Object.prototype.hasOwnProperty\nconst defaultOptions = {timeout: isReactNative ? 60000 : 120000}\n\nmodule.exports = opts => {\n  const options =\n    typeof opts === 'string'\n      ? objectAssign({url: opts}, defaultOptions)\n      : objectAssign({}, defaultOptions, opts)\n\n  // Parse URL into parts\n  const url = urlParse(\n    options.url,\n    {}, // Don't use current browser location\n    true // Parse query strings\n  )\n\n  // Normalize timeouts\n  options.timeout = normalizeTimeout(options.timeout)\n\n  // Shallow-merge (override) existing query params\n  if (options.query) {\n    url.query = objectAssign({}, url.query, removeUndefined(options.query))\n  }\n\n  // Implicit POST if we have not specified a method but have a body\n  options.method =\n    options.body && !options.method ? 'POST' : (options.method || 'GET').toUpperCase()\n\n  // Stringify URL\n  options.url = url.toString(stringifyQueryString)\n\n  return options\n}\n\nfunction stringifyQueryString(obj) {\n  const pairs = []\n  for (const key in obj) {\n    if (has.call(obj, key)) {\n      push(key, obj[key])\n    }\n  }\n\n  return pairs.length ? pairs.join('&') : ''\n\n  function push(key, val) {\n    if (Array.isArray(val)) {\n      val.forEach(item => push(key, item))\n    } else {\n      pairs.push([key, val].map(encodeURIComponent).join('='))\n    }\n  }\n}\n\nfunction normalizeTimeout(time) {\n  if (time === false || time === 0) {\n    return false\n  }\n\n  if (time.connect || time.socket) {\n    return time\n  }\n\n  const delay = Number(time)\n  if (isNaN(delay)) {\n    return normalizeTimeout(defaultOptions.timeout)\n  }\n\n  return {connect: delay, socket: delay}\n}\n\nfunction removeUndefined(obj) {\n  const target = {}\n  for (const key in obj) {\n    if (obj[key] !== undefined) {\n      target[key] = obj[key]\n    }\n  }\n  return target\n}\n"]}