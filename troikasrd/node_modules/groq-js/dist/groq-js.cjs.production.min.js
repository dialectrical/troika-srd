"use strict";class t{constructor(t,e,n){this.visitor=t,this.string=e,this.marks=n,this.index=0}hasMark(t){return void 0===t&&(t=0),this.index+t<this.marks.length}getMark(t){return void 0===t&&(t=0),this.marks[this.index+t]}shift(){this.index+=1}process(){var t=this.marks[this.index];this.shift();var e=this.visitor[t.name];if(!e)throw new Error("Unknown handler: "+t.name);return e.call(this.visitor,this,t)}processString(){return this.shift(),this.processStringEnd()}processStringEnd(){var t=this.marks[this.index-1],e=this.marks[this.index];return this.shift(),this.string.slice(t.position,e.position)}}function e(t){var e;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(e=t[Symbol.asyncIterator]))return e.call(t);if(Symbol.iterator&&null!=(e=t[Symbol.iterator]))return e.call(t)}throw new TypeError("Object is not async iterable")}function n(t){this.wrapped=t}function r(t){var e,r;function a(e,r){try{var i=t[e](r),o=i.value,u=o instanceof n;Promise.resolve(u?o.wrapped:o).then((function(t){u?a("return"===e?"return":"next",t):d(i.done?"return":"normal",t)}),(function(t){a("throw",t)}))}catch(t){d("throw",t)}}function d(t,n){switch(t){case"return":e.resolve({value:n,done:!0});break;case"throw":e.reject(n);break;default:e.resolve({value:n,done:!1})}(e=e.next)?a(e.key,e.arg):r=null}this._invoke=function(t,n){return new Promise((function(d,i){var o={key:t,arg:n,resolve:d,reject:i,next:null};r?r=r.next=o:(e=r=o,a(t,n))}))},"function"!=typeof t.return&&(this.return=void 0)}function a(t){return function(){return new r(t.apply(this,arguments))}}function d(t){return new n(t)}function i(t,e,n,r,a,d,i){try{var o=t[d](i),u=o.value}catch(t){return void n(t)}o.done?e(u):Promise.resolve(u).then(r,a)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var d=t.apply(e,n);function o(t){i(d,r,a,o,u,"next",t)}function u(t){i(d,r,a,o,u,"throw",t)}o(void 0)}))}}function u(){return(u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return l(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,void 0):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}function s(t){return null==t?"null":Array.isArray(t)?"array":t instanceof C?"range":t instanceof N?"pair":t instanceof v?"path":typeof t}"function"==typeof Symbol&&Symbol.asyncIterator&&(r.prototype[Symbol.asyncIterator]=function(){return this}),r.prototype.next=function(t){return this._invoke("next",t)},r.prototype.throw=function(t){return this._invoke("throw",t)},r.prototype.return=function(t){return this._invoke("return",t)};class p{constructor(t){this.data=t}getType(){return s(this.data)}get(){var t=this;return o((function*(){return t.data}))()}[Symbol.asyncIterator](){if(Array.isArray(this.data))return function*(t){for(var e,n=c(t);!(e=n()).done;){var r=e.value;yield new p(r)}}(this.data);throw new Error("Cannot iterate over: "+this.getType())}getBoolean(){return"boolean"==typeof this.data&&!0===this.data}}var f=new p(null),x=new p(!0),y=new p(!1);class w{constructor(t){this.generator=t,this.ticker=null,this.isDone=!1,this.data=[]}getType(){return"array"}get(){var t=this;return o((function*(){var n,r=[],a=!0,d=!1;try{for(var i,o,u=e(t);a=(i=yield u.next()).done,o=yield i.value,!a;a=!0){var l=o;r.push(yield l.get())}}catch(t){d=!0,n=t}finally{try{a||null==u.return||(yield u.return())}finally{if(d)throw n}}return r}))()}[Symbol.asyncIterator](){var t=this;return a((function*(){for(var e=0;;){for(;e<t.data.length;e++)yield t.data[e];if(t.isDone)return;yield d(t._nextTick())}}))()}getBoolean(){return!1}_nextTick(){var t,n=this;if(this.ticker)return this.ticker;var r=()=>{this.ticker=new Promise(e=>{t=e})},a=()=>{t(),r()},d=function(){var t=o((function*(){var t,r=!0,d=!1;try{for(var i,o,u=e(n.generator());r=(i=yield u.next()).done,o=yield i.value,!r;r=!0)n.data.push(o),a()}catch(e){d=!0,t=e}finally{try{r||null==u.return||(yield u.return())}finally{if(d)throw t}}n.isDone=!0,a()}));return function(){return t.apply(this,arguments)}}();return r(),d(),this.ticker}}class R{constructor(t){this.value=t}getType(){return"array"}get(){var t=this;return o((function*(){return yield t.value.get()}))()}[Symbol.asyncIterator](){return this.value[Symbol.asyncIterator].call(this.value)}getBoolean(){return!1}}class C{constructor(t,e,n){this.left=t,this.right=e,this.exclusive=n}static isConstructible(t,e){if(t===e){if("number"===t)return!0;if("string"===t)return!0;if("boolean"===t)return!0}return!1}isExclusive(){return this.exclusive}toJSON(){return[this.left,this.right]}}class N{constructor(t,e){this.first=t,this.second=e}toJSON(){return[this.first,this.second]}}class v{constructor(t){this.pattern=t,this.patternRe=function(t){for(var e,n=[],r=c(t.split("."));!(e=r()).done;){var a=e.value;n.push("*"===a?"[^.]+":"**"===a?".*":a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))}return new RegExp("^"+n.join(".")+"$")}(t)}matches(t){return this.patternRe.test(t)}toJSON(){return this.pattern}}function h(t){return Number.isFinite(t)?new p(t):f}function S(t){return(n=t)&&"function"==typeof n.next?new w(a((function*(){var n,r=!0,a=!1;try{for(var i,o,u=e(t);r=(i=yield d(u.next())).done,o=yield d(i.value),!r;r=!0){var l=o;yield new p(l)}}catch(t){a=!0,n=t}finally{try{r||null==u.return||(yield d(u.return()))}finally{if(a)throw n}}}))):null==t?f:new p(t);var n}var E={number:1,string:2,boolean:3};function k(t,e){var n=s(t);if(n!==s(e))return null;switch(n){case"number":case"boolean":return t-e;case"string":return t<e?-1:t>e?1:0}return null}function g(t,e){var n=s(t),r=s(e),a=E[n]||100,d=E[r]||100;if(a!==d)return a-d;var i=k(t,e);return null===i&&(i=0),i}var I={};I.coalesce=function(){var t=o((function*(t,e,n){for(var r,a=c(t);!(r=a()).done;){var d=r.value,i=yield n(d,e);if("null"!==i.getType())return i}return f}));return function(e,n,r){return t.apply(this,arguments)}}(),I.count=function(){var t=o((function*(t,n,r){var a=yield r(t[0],n);if("array"!==a.getType())return f;var d,i=0,o=!0,u=!1;try{for(var l,c=e(a);o=(l=yield c.next()).done,yield l.value,!o;o=!0)i++}catch(t){u=!0,d=t}finally{try{o||null==c.return||(yield c.return())}finally{if(u)throw d}}return new p(i)}));return function(e,n,r){return t.apply(this,arguments)}}(),I.count.arity=1,I.defined=function(){var t=o((function*(t,e,n){return"null"===(yield n(t[0],e)).getType()?y:x}));return function(e,n,r){return t.apply(this,arguments)}}(),I.defined.arity=1,I.identity=function(){var t=o((function*(t){return new p("me")}));return function(e){return t.apply(this,arguments)}}(),I.identity.arity=0,I.length=function(){var t=o((function*(t,e,n){var r=yield n(t[0],e);return"string"===r.getType()?h(function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r>=55296&&r<=56319||e++}return e}(yield r.get())):f}));return function(e,n,r){return t.apply(this,arguments)}}(),I.length.arity=1,I.path=function(){var t=o((function*(t,e,n){var r=yield n(t[0],e);if("string"!==r.getType())return f;var a=yield r.get();return new p(new v(a))}));return function(e,n,r){return t.apply(this,arguments)}}(),I.path.arity=1,I.select=function(){var t=o((function*(t,e,n){for(var r,a=!1,d=c(t);!(r=d()).done;){if(a)return f;"Pair"===r.value.type||(a=!0)}for(var i,o=c(t);!(i=o()).done;){var u=i.value;if("Pair"!==u.type)return yield n(u,e);if((yield n(u.left,e)).getBoolean())return yield n(u.right,e)}return f}));return function(e,n,r){return t.apply(this,arguments)}}(),I.references=function(){var t=o((function*(t,e,n){var r=yield n(t[0],e);if("string"!==r.getType())return y;var a=yield r.get();return function t(e,n){switch(s(e)){case"array":for(var r,a=c(e);!(r=a()).done;)if(t(r.value,n))return!0;break;case"object":if(e._ref===n)return!0;for(var d=0,i=Object.values(e);d<i.length;d++)if(t(i[d],n))return!0}return!1}(e.value,a)?x:y}));return function(e,n,r){return t.apply(this,arguments)}}(),I.references.arity=1,I.round=function(){var t=o((function*(t,e,n){var r=yield n(t[0],e);if("number"!==r.getType())return f;var a=yield r.get(),d=0;if(2===t.length){var i=yield n(t[1],e);if("number"!==i.getType())return f;d=yield i.get()}return h(0===d?Math.round(a):Number(a.toFixed(d)))}));return function(e,n,r){return t.apply(this,arguments)}}(),I.round.arity=t=>t>=1&&t<=2,I.now=function(){var t=o((function*(t,e){return new p(e.timestamp)}));return function(e,n){return t.apply(this,arguments)}}(),I.now.arity=0;var P={};function G(){}function T(t,e){this.token=t,this.position=e,this.nextFrames=[],this.acceptedContexts=[],this.callers={}}function b(){this.returns=[]}function m(t,e){this.caller=t,this.marks=e}function X(t){this.context=t,this.nextStates=[]}function _(t,e,n){for(var r=new T(t,e),a=0;a<n.length;a++)M(r,n[a]);return r}function M(t,e){var n=e.copy();e.eachNextState((function(e){e.p(t,n)})),A(t,n)}function A(t,e){e.hasNextStates()&&t.addNextFrame(e)}P.order=function(){var t=o((function*(t,n,r,a){if(yield!0,"array"!==t.getType())return f;for(var d,i=[],o=[],u=0,l=c(n);!(d=l()).done;){var s=d.value,x="asc";"Desc"===s.type?(x="desc",s=s.base):"Asc"===s.type&&(s=s.base),i.push(s),o.push(x),u++}var y,w=[],R=!0,C=!1;try{for(var N,v,h=e(t);R=(N=yield h.next()).done,v=yield N.value,!R;R=!0){for(var S=v,E=r.createNested(S),k=[yield S.get()],I=0;I<u;I++){var P=yield a(i[I],E);k.push(yield P.get())}w.push(k)}}catch(t){C=!0,y=t}finally{try{R||null==h.return||(yield h.return())}finally{if(C)throw y}}return w.sort((t,e)=>{for(var n=0;n<u;n++){var r=g(t[n+1],e[n+1]);if("desc"===o[n]&&(r=-r),0!==r)return r}return 0}),new p(w.map(t=>t[0]))}));return function(e,n,r,a){return t.apply(this,arguments)}}(),P.order.arity=t=>t>=1,T.prototype.hasNextFrames=function(){return this.nextFrames.length>0},T.prototype.addNextFrame=function(t){this.nextFrames.push(t)},T.prototype.wasAccepted=function(){return this.acceptedContexts.length>0},T.prototype.addAccept=function(t){this.acceptedContexts.push(t)},T.prototype.addMark=function(t,e,n){var r={type:"mark",name:t,position:this.position},a=new X(new m(e.caller,e.marks?{type:"concat",left:e.marks,right:r}:r));n.p(this,a),A(this,a)},T.prototype.startCall=function(t){var e=this.callers[t];if(!e){e=new b,this.callers[t]=e;for(var n=new X(new m(e,null)),r=Bi[t],a=0;a<r.length;a++)r[a].p(this,n);A(this,n)}return e},T.prototype.returnCall=function(t,e){for(var n=e.context.caller.returns,r=0;r<n.length;r++){var a=n[r],d=a[0],i=a[1],o=d.marks,u=e.context.marks,l=new X(new m(d.caller,o&&u?{type:"concat",left:d.marks,right:e.context.marks}:o||u));i.p(this,l),A(this,l)}},b.prototype.addReturn=function(t,e){this.returns.push([t,e])},X.prototype.addNextState=function(t){this.nextStates.push(t)},X.prototype.eachNextState=function(t){this.nextStates.forEach(t)},X.prototype.hasNextStates=function(){return this.nextStates.length>0},X.prototype.copy=function(){return new X(this.context,this.marks)};var O=new G,D=new G,j=new G,F=new G,B=new G,U=new G,J=new G,L=new G,V=new G,H=new G,Y=new G,q=new G,$=new G,z=new G,Z=new G,Q=new G,K=new G,W=new G,tt=new G,et=new G,nt=new G,rt=new G,at=new G,dt=new G,it=new G,ot=new G,ut=new G,lt=new G,ct=new G,st=new G,pt=new G,ft=new G,xt=new G,yt=new G,wt=new G,Rt=new G,Ct=new G,Nt=new G,vt=new G,ht=new G,St=new G,Et=new G,kt=new G,gt=new G,It=new G,Pt=new G,Gt=new G,Tt=new G,bt=new G,mt=new G,Xt=new G,_t=new G,Mt=new G,At=new G,Ot=new G,Dt=new G,jt=new G,Ft=new G,Bt=new G,Ut=new G,Jt=new G,Lt=new G,Vt=new G,Ht=new G,Yt=new G,qt=new G,$t=new G,zt=new G,Zt=new G,Qt=new G,Kt=new G,Wt=new G,te=new G,ee=new G,ne=new G,re=new G,ae=new G,de=new G,ie=new G,oe=new G,ue=new G,le=new G,ce=new G,se=new G,pe=new G,fe=new G,xe=new G,ye=new G,we=new G,Re=new G,Ce=new G,Ne=new G,ve=new G,he=new G,Se=new G,Ee=new G,ke=new G,ge=new G,Ie=new G,Pe=new G,Ge=new G,Te=new G,be=new G,me=new G,Xe=new G,_e=new G,Me=new G,Ae=new G,Oe=new G,De=new G,je=new G,Fe=new G,Be=new G,Ue=new G,Je=new G,Le=new G,Ve=new G,He=new G,Ye=new G,qe=new G,$e=new G,ze=new G,Ze=new G,Qe=new G,Ke=new G,We=new G,tn=new G,en=new G,nn=new G,rn=new G,an=new G,dn=new G,on=new G,un=new G,ln=new G,cn=new G,sn=new G,pn=new G,fn=new G,xn=new G,yn=new G,wn=new G,Rn=new G,Cn=new G,Nn=new G,vn=new G,hn=new G,Sn=new G,En=new G,kn=new G,gn=new G,In=new G,Pn=new G,Gn=new G,Tn=new G,bn=new G,mn=new G,Xn=new G,_n=new G,Mn=new G,An=new G,On=new G,Dn=new G,jn=new G,Fn=new G,Bn=new G,Un=new G,Jn=new G,Ln=new G,Vn=new G,Hn=new G,Yn=new G,qn=new G,$n=new G,zn=new G,Zn=new G,Qn=new G,Kn=new G,Wn=new G,tr=new G,er=new G,nr=new G,rr=new G,ar=new G,dr=new G,ir=new G,or=new G,ur=new G,lr=new G,cr=new G,sr=new G,pr=new G,fr=new G,xr=new G,yr=new G,wr=new G,Rr=new G,Cr=new G,Nr=new G,vr=new G,hr=new G,Sr=new G,Er=new G,kr=new G,gr=new G,Ir=new G,Pr=new G,Gr=new G,Tr=new G,br=new G,mr=new G,Xr=new G,_r=new G,Mr=new G,Ar=new G,Or=new G,Dr=new G,jr=new G,Fr=new G,Br=new G,Ur=new G,Jr=new G,Lr=new G,Vr=new G,Hr=new G,Yr=new G,qr=new G,$r=new G,zr=new G,Zr=new G,Qr=new G,Kr=new G,Wr=new G,ta=new G,ea=new G,na=new G,ra=new G,aa=new G,da=new G,ia=new G,oa=new G,ua=new G,la=new G,ca=new G,sa=new G,pa=new G,fa=new G,xa=new G,ya=new G,wa=new G,Ra=new G,Ca=new G,Na=new G,va=new G,ha=new G,Sa=new G,Ea=new G,ka=new G,ga=new G,Ia=new G,Pa=new G,Ga=new G,Ta=new G,ba=new G,ma=new G,Xa=new G,_a=new G,Ma=new G,Aa=new G,Oa=new G,Da=new G,ja=new G,Fa=new G,Ba=new G,Ua=new G,Ja=new G,La=new G,Va=new G,Ha=new G,Ya=new G,qa=new G,$a=new G,za=new G,Za=new G,Qa=new G,Ka=new G,Wa=new G,td=new G,ed=new G,nd=new G,rd=new G,ad=new G,dd=new G,id=new G,od=new G,ud=new G,ld=new G,cd=new G,sd=new G,pd=new G,fd=new G,xd=new G,yd=new G,wd=new G,Rd=new G,Cd=new G,Nd=new G,vd=new G,hd=new G,Sd=new G,Ed=new G,kd=new G,gd=new G,Id=new G,Pd=new G,Gd=new G,Td=new G,bd=new G,md=new G,Xd=new G,_d=new G,Md=new G,Ad=new G,Od=new G,Dd=new G,jd=new G,Fd=new G,Bd=new G,Ud=new G,Jd=new G,Ld=new G,Vd=new G,Hd=new G,Yd=new G,qd=new G,$d=new G,zd=new G,Zd=new G,Qd=new G,Kd=new G,Wd=new G,ti=new G,ei=new G,ni=new G,ri=new G,ai=new G,di=new G,ii=new G,oi=new G,ui=new G,li=new G,ci=new G,si=new G,pi=new G,fi=new G,xi=new G,yi=new G,wi=new G,Ri=new G,Ci=new G,Ni=new G,vi=new G,hi=new G,Si=new G,Ei=new G,ki=new G,gi=new G,Ii=new G,Pi=new G,Gi=new G,Ti=new G,bi=new G,mi=new G,Xi=new G,_i=new G,Mi=new G,Ai=new G,Oi=new G,Di=new G;O.p=function(t,e){t.startCall("main").addReturn(e.context,D)},O.id=0,D.p=function(t,e){t.addAccept(e.context)},D.id=1,j.p=function(t,e){t.startCall("IGN").addReturn(e.context,F),t.startCall("EXPR^1").addReturn(e.context,B)},j.id=2,F.p=function(t,e){t.startCall("IGN").addReturn(e.context,F),t.startCall("EXPR^1").addReturn(e.context,B)},F.id=3,B.p=function(t,e){t.startCall("IGN").addReturn(e.context,U),t.returnCall("main",e)},B.id=4,U.p=function(t,e){t.startCall("IGN").addReturn(e.context,U),t.returnCall("main",e)},U.id=5,J.p=function(t,e){var n=t.token;9===n&&e.addNextState(L),10===n&&e.addNextState(V),11===n&&e.addNextState(H),12===n&&e.addNextState(Y),13===n&&e.addNextState(q),32===n&&e.addNextState($),133===n&&e.addNextState(z),160===n&&e.addNextState(Z)},J.id=6,L.p=function(t,e){t.returnCall("SPACE",e)},L.id=7,V.p=function(t,e){t.returnCall("SPACE",e)},V.id=8,H.p=function(t,e){t.returnCall("SPACE",e)},H.id=9,Y.p=function(t,e){t.returnCall("SPACE",e)},Y.id=10,q.p=function(t,e){t.returnCall("SPACE",e)},q.id=11,$.p=function(t,e){t.returnCall("SPACE",e)},$.id=12,z.p=function(t,e){t.returnCall("SPACE",e)},z.id=13,Z.p=function(t,e){t.returnCall("SPACE",e)},Z.id=14,Q.p=function(t,e){47===t.token&&e.addNextState(K)},Q.id=15,K.p=function(t,e){47===t.token&&e.addNextState(W)},K.id=16,W.p=function(t,e){var n=t.token;n<=9&&e.addNextState(tt),n>=11&&e.addNextState(et)},W.id=17,tt.p=function(t,e){var n=t.token;n<=9&&e.addNextState(tt),n>=11&&e.addNextState(et),t.startCall("COMMENT_END").addReturn(e.context,nt)},tt.id=18,et.p=function(t,e){var n=t.token;n<=9&&e.addNextState(tt),n>=11&&e.addNextState(et),t.startCall("COMMENT_END").addReturn(e.context,nt)},et.id=19,nt.p=function(t,e){t.returnCall("COMMENT",e)},nt.id=20,rt.p=function(t,e){10===t.token&&e.addNextState(at)},rt.id=21,at.p=function(t,e){t.returnCall("COMMENT_END",e)},at.id=22,dt.p=function(t,e){t.startCall("SPACE").addReturn(e.context,it),t.startCall("COMMENT").addReturn(e.context,ot)},dt.id=23,it.p=function(t,e){t.returnCall("IGN",e)},it.id=24,ot.p=function(t,e){t.returnCall("IGN",e)},ot.id=25,ut.p=function(t,e){124===t.token&&e.addNextState(lt)},ut.id=26,lt.p=function(t,e){t.startCall("IGN").addReturn(e.context,ct),t.returnCall("PIPE",e)},lt.id=27,ct.p=function(t,e){t.startCall("IGN").addReturn(e.context,ct),t.returnCall("PIPE",e)},ct.id=28,st.p=function(t,e){t.addMark("parent",e.context,pt),t.addMark("dblparent",e.context,ft)},st.id=29,pt.p=function(t,e){94===t.token&&e.addNextState(xt)},pt.id=30,ft.p=function(t,e){t.startCall("PARENT").addReturn(e.context,yt)},ft.id=31,xt.p=function(t,e){t.returnCall("PARENT",e)},xt.id=32,yt.p=function(t,e){46===t.token&&e.addNextState(wt)},yt.id=33,wt.p=function(t,e){94===t.token&&e.addNextState(Rt)},wt.id=34,Rt.p=function(t,e){t.returnCall("PARENT",e)},Rt.id=35,Ct.p=function(t,e){var n=t.token;n>=97&&n<=122&&e.addNextState(Nt),n>=65&&n<=90&&e.addNextState(vt),95===n&&e.addNextState(ht)},Ct.id=36,Nt.p=function(t,e){t.returnCall("IDENT_FST",e)},Nt.id=37,vt.p=function(t,e){t.returnCall("IDENT_FST",e)},vt.id=38,ht.p=function(t,e){t.returnCall("IDENT_FST",e)},ht.id=39,St.p=function(t,e){var n=t.token;t.startCall("IDENT_FST").addReturn(e.context,Et),n>=48&&n<=57&&e.addNextState(kt)},St.id=40,Et.p=function(t,e){t.returnCall("IDENT_REST",e)},Et.id=41,kt.p=function(t,e){t.returnCall("IDENT_REST",e)},kt.id=42,gt.p=function(t,e){t.startCall("IDENT_FST").addReturn(e.context,It)},gt.id=43,It.p=function(t,e){var n=t.token;t.startCall("IDENT_REST").addReturn(e.context,Pt),(n<=96||n>=123)&&(n<=64||n>=91)&&(n<=47||n>=58)&&t.returnCall("IDENT",e)},It.id=44,Pt.p=function(t,e){var n=t.token;t.startCall("IDENT_REST").addReturn(e.context,Pt),(n<=96||n>=123)&&(n<=64||n>=91)&&(n<=47||n>=58)&&t.returnCall("IDENT",e)},Pt.id=45,Gt.p=function(t,e){42===t.token&&e.addNextState(Tt)},Gt.id=46,Tt.p=function(t,e){var n=t.token;(n<=41||n>=43)&&t.returnCall("STAR",e)},Tt.id=47,bt.p=function(t,e){var n=t.token;61===n&&e.addNextState(mt),33===n&&e.addNextState(Xt),62===n&&e.addNextState(_t),62===n&&e.addNextState(Mt),60===n&&e.addNextState(At),60===n&&e.addNextState(Ot),105===n&&e.addNextState(Dt),109===n&&e.addNextState(jt)},bt.id=48,mt.p=function(t,e){61===t.token&&e.addNextState(Ft)},mt.id=49,Xt.p=function(t,e){61===t.token&&e.addNextState(Bt)},Xt.id=50,_t.p=function(t,e){61===t.token&&e.addNextState(Ut)},_t.id=51,Mt.p=function(t,e){t.returnCall("COMP_OP",e)},Mt.id=52,At.p=function(t,e){61===t.token&&e.addNextState(Jt)},At.id=53,Ot.p=function(t,e){t.returnCall("COMP_OP",e)},Ot.id=54,Dt.p=function(t,e){110===t.token&&e.addNextState(Lt)},Dt.id=55,jt.p=function(t,e){97===t.token&&e.addNextState(Vt)},jt.id=56,Ft.p=function(t,e){t.returnCall("COMP_OP",e)},Ft.id=57,Bt.p=function(t,e){t.returnCall("COMP_OP",e)},Bt.id=58,Ut.p=function(t,e){t.returnCall("COMP_OP",e)},Ut.id=59,Jt.p=function(t,e){t.returnCall("COMP_OP",e)},Jt.id=60,Lt.p=function(t,e){t.returnCall("COMP_OP",e)},Lt.id=61,Vt.p=function(t,e){116===t.token&&e.addNextState(Ht)},Vt.id=62,Ht.p=function(t,e){99===t.token&&e.addNextState(Yt)},Ht.id=63,Yt.p=function(t,e){104===t.token&&e.addNextState(qt)},Yt.id=64,qt.p=function(t,e){t.returnCall("COMP_OP",e)},qt.id=65,$t.p=function(t,e){t.addMark("func_call",e.context,zt)},$t.id=66,zt.p=function(t,e){t.startCall("IDENT").addReturn(e.context,Zt)},zt.id=67,Zt.p=function(t,e){t.addMark("func_name_end",e.context,Qt)},Zt.id=68,Qt.p=function(t,e){40===t.token&&e.addNextState(Kt)},Qt.id=69,Kt.p=function(t,e){t.startCall("IGN").addReturn(e.context,Wt),t.startCall("FUNC_ARGS").addReturn(e.context,te),t.addMark("func_args_end",e.context,ee)},Kt.id=70,Wt.p=function(t,e){t.startCall("IGN").addReturn(e.context,Wt),t.startCall("FUNC_ARGS").addReturn(e.context,te),t.addMark("func_args_end",e.context,ee)},Wt.id=71,te.p=function(t,e){t.addMark("func_args_end",e.context,ee)},te.id=72,ee.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ne),41===n&&e.addNextState(re)},ee.id=73,ne.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ne),41===n&&e.addNextState(re)},ne.id=74,re.p=function(t,e){t.returnCall("FUNC_CALL",e)},re.id=75,ae.p=function(t,e){t.startCall("EXPR^1").addReturn(e.context,de)},ae.id=76,de.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ie),44===n&&e.addNextState(ue),t.returnCall("FUNC_ARGS",e)},de.id=77,ie.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ie),44===n&&e.addNextState(ue),t.returnCall("FUNC_ARGS",e)},ie.id=78,oe.p=function(t,e){t.startCall("IGN").addReturn(e.context,oe),t.startCall("EXPR^1").addReturn(e.context,le)},oe.id=79,ue.p=function(t,e){t.startCall("IGN").addReturn(e.context,oe),t.startCall("EXPR^1").addReturn(e.context,le)},ue.id=80,le.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ce),44===n&&e.addNextState(ue),t.returnCall("FUNC_ARGS",e)},le.id=81,ce.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ce),44===n&&e.addNextState(ue),t.returnCall("FUNC_ARGS",e)},ce.id=82,se.p=function(t,e){t.addMark("sci",e.context,pe),t.addMark("float",e.context,fe),t.addMark("integer",e.context,xe)},se.id=83,pe.p=function(t,e){t.startCall("DIGIT").addReturn(e.context,ye)},pe.id=84,fe.p=function(t,e){t.startCall("DIGIT").addReturn(e.context,Ee)},fe.id=85,xe.p=function(t,e){t.startCall("DIGIT").addReturn(e.context,Pe)},xe.id=86,ye.p=function(t,e){var n=t.token;t.startCall("DIGIT").addReturn(e.context,ye),46===n&&e.addNextState(Re),101===n&&e.addNextState(Ce),69===n&&e.addNextState(Ne)},ye.id=87,we.p=function(t,e){var n=t.token;t.startCall("DIGIT").addReturn(e.context,we),101===n&&e.addNextState(Ce),69===n&&e.addNextState(Ne)},we.id=88,Re.p=function(t,e){t.startCall("DIGIT").addReturn(e.context,we)},Re.id=89,Ce.p=function(t,e){t.startCall("SIGN").addReturn(e.context,ve),t.startCall("DIGIT").addReturn(e.context,he)},Ce.id=90,Ne.p=function(t,e){t.startCall("SIGN").addReturn(e.context,ve),t.startCall("DIGIT").addReturn(e.context,he)},Ne.id=91,ve.p=function(t,e){t.startCall("DIGIT").addReturn(e.context,he)},ve.id=92,he.p=function(t,e){t.startCall("DIGIT").addReturn(e.context,he),t.addMark("sci_end",e.context,Se)},he.id=93,Se.p=function(t,e){t.returnCall("NUMBER",e)},Se.id=94,Ee.p=function(t,e){var n=t.token;t.startCall("DIGIT").addReturn(e.context,Ee),46===n&&e.addNextState(ke)},Ee.id=95,ke.p=function(t,e){t.startCall("DIGIT").addReturn(e.context,ge)},ke.id=96,ge.p=function(t,e){t.startCall("DIGIT").addReturn(e.context,ge),t.addMark("float_end",e.context,Ie)},ge.id=97,Ie.p=function(t,e){t.returnCall("NUMBER",e)},Ie.id=98,Pe.p=function(t,e){t.startCall("DIGIT").addReturn(e.context,Pe),t.addMark("integer_end",e.context,Ge)},Pe.id=99,Ge.p=function(t,e){t.returnCall("NUMBER",e)},Ge.id=100,Te.p=function(t,e){var n=t.token;n>=48&&n<=57&&e.addNextState(be)},Te.id=101,be.p=function(t,e){t.returnCall("DIGIT",e)},be.id=102,me.p=function(t,e){var n=t.token;43===n&&e.addNextState(Xe),45===n&&e.addNextState(_e)},me.id=103,Xe.p=function(t,e){t.returnCall("SIGN",e)},Xe.id=104,_e.p=function(t,e){t.returnCall("SIGN",e)},_e.id=105,Me.p=function(t,e){var n=t.token;34===n&&e.addNextState(Ae),39===n&&e.addNextState(Oe)},Me.id=106,Ae.p=function(t,e){t.addMark("str_begin",e.context,De)},Ae.id=107,Oe.p=function(t,e){t.addMark("str_begin",e.context,Ue)},Oe.id=108,De.p=function(t,e){t.startCall("DSTRING_CHAR").addReturn(e.context,je),t.addMark("str_end",e.context,Fe)},De.id=109,je.p=function(t,e){t.startCall("DSTRING_CHAR").addReturn(e.context,je),t.addMark("str_end",e.context,Fe)},je.id=110,Fe.p=function(t,e){34===t.token&&e.addNextState(Be)},Fe.id=111,Be.p=function(t,e){t.returnCall("STRING",e)},Be.id=112,Ue.p=function(t,e){t.startCall("SSTRING_CHAR").addReturn(e.context,Je),t.addMark("str_end",e.context,Le)},Ue.id=113,Je.p=function(t,e){t.startCall("SSTRING_CHAR").addReturn(e.context,Je),t.addMark("str_end",e.context,Le)},Je.id=114,Le.p=function(t,e){39===t.token&&e.addNextState(Ve)},Le.id=115,Ve.p=function(t,e){t.returnCall("STRING",e)},Ve.id=116,He.p=function(t,e){var n=t.token;92===n&&e.addNextState(Ye),(n<=33||n>=35)&&(n<=91||n>=93)&&e.addNextState(qe)},He.id=117,Ye.p=function(t,e){e.addNextState($e)},Ye.id=118,qe.p=function(t,e){t.returnCall("DSTRING_CHAR",e)},qe.id=119,$e.p=function(t,e){t.returnCall("DSTRING_CHAR",e)},$e.id=120,ze.p=function(t,e){var n=t.token;92===n&&e.addNextState(Ze),(n<=38||n>=40)&&(n<=91||n>=93)&&e.addNextState(Qe)},ze.id=121,Ze.p=function(t,e){e.addNextState(Ke)},Ze.id=122,Qe.p=function(t,e){t.returnCall("SSTRING_CHAR",e)},Qe.id=123,Ke.p=function(t,e){t.returnCall("SSTRING_CHAR",e)},Ke.id=124,We.p=function(t,e){t.addMark("array",e.context,tn)},We.id=125,tn.p=function(t,e){91===t.token&&e.addNextState(en)},tn.id=126,en.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,nn),t.startCall("ARRAY_ELEMENT").addReturn(e.context,an),93===n&&e.addNextState(pn)},en.id=127,nn.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,nn),t.startCall("ARRAY_ELEMENT").addReturn(e.context,an),93===n&&e.addNextState(pn)},nn.id=128,rn.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,rn),44===n&&e.addNextState(on),44===n&&e.addNextState(sn),93===n&&e.addNextState(pn)},rn.id=129,an.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,rn),44===n&&e.addNextState(on),44===n&&e.addNextState(sn),93===n&&e.addNextState(pn)},an.id=130,dn.p=function(t,e){t.startCall("IGN").addReturn(e.context,dn),t.startCall("ARRAY_ELEMENT").addReturn(e.context,un)},dn.id=131,on.p=function(t,e){t.startCall("IGN").addReturn(e.context,dn),t.startCall("ARRAY_ELEMENT").addReturn(e.context,un)},on.id=132,un.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ln),44===n&&e.addNextState(on),44===n&&e.addNextState(sn),93===n&&e.addNextState(pn)},un.id=133,ln.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ln),44===n&&e.addNextState(on),44===n&&e.addNextState(sn),93===n&&e.addNextState(pn)},ln.id=134,cn.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,cn),93===n&&e.addNextState(pn)},cn.id=135,sn.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,cn),93===n&&e.addNextState(pn)},sn.id=136,pn.p=function(t,e){t.addMark("array_end",e.context,fn)},pn.id=137,fn.p=function(t,e){t.returnCall("ARRAY",e)},fn.id=138,xn.p=function(t,e){t.addMark("array_splat",e.context,yn),t.startCall("EXPR^1").addReturn(e.context,wn)},xn.id=139,yn.p=function(t,e){46===t.token&&e.addNextState(Rn)},yn.id=140,wn.p=function(t,e){t.returnCall("ARRAY_ELEMENT",e)},wn.id=141,Rn.p=function(t,e){46===t.token&&e.addNextState(Cn)},Rn.id=142,Cn.p=function(t,e){46===t.token&&e.addNextState(Nn)},Cn.id=143,Nn.p=function(t,e){t.startCall("IGN").addReturn(e.context,vn),t.startCall("EXPR^1").addReturn(e.context,wn)},Nn.id=144,vn.p=function(t,e){t.startCall("IGN").addReturn(e.context,vn),t.startCall("EXPR^1").addReturn(e.context,wn)},vn.id=145,hn.p=function(t,e){t.addMark("object",e.context,Sn)},hn.id=146,Sn.p=function(t,e){123===t.token&&e.addNextState(En)},Sn.id=147,En.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,kn),t.startCall("OBJECT_PAIR").addReturn(e.context,In),125===n&&e.addNextState(_n)},En.id=148,kn.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,kn),t.startCall("OBJECT_PAIR").addReturn(e.context,In),125===n&&e.addNextState(_n)},kn.id=149,gn.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,gn),44===n&&e.addNextState(Gn),44===n&&e.addNextState(Xn),125===n&&e.addNextState(_n)},gn.id=150,In.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,gn),44===n&&e.addNextState(Gn),44===n&&e.addNextState(Xn),125===n&&e.addNextState(_n)},In.id=151,Pn.p=function(t,e){t.startCall("IGN").addReturn(e.context,Pn),t.startCall("OBJECT_PAIR").addReturn(e.context,Tn)},Pn.id=152,Gn.p=function(t,e){t.startCall("IGN").addReturn(e.context,Pn),t.startCall("OBJECT_PAIR").addReturn(e.context,Tn)},Gn.id=153,Tn.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,bn),44===n&&e.addNextState(Gn),44===n&&e.addNextState(Xn),125===n&&e.addNextState(_n)},Tn.id=154,bn.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,bn),44===n&&e.addNextState(Gn),44===n&&e.addNextState(Xn),125===n&&e.addNextState(_n)},bn.id=155,mn.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,mn),125===n&&e.addNextState(_n)},mn.id=156,Xn.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,mn),125===n&&e.addNextState(_n)},Xn.id=157,_n.p=function(t,e){t.addMark("object_end",e.context,Mn)},_n.id=158,Mn.p=function(t,e){t.returnCall("OBJECT",e)},Mn.id=159,An.p=function(t,e){t.addMark("object_pair",e.context,On),t.addMark("object_expr",e.context,Dn),t.addMark("object_splat_this",e.context,jn),t.addMark("object_splat",e.context,Fn)},An.id=160,On.p=function(t,e){t.startCall("STRING").addReturn(e.context,Bn)},On.id=161,Dn.p=function(t,e){t.startCall("EXPR^1").addReturn(e.context,Hn)},Dn.id=162,jn.p=function(t,e){46===t.token&&e.addNextState(Yn)},jn.id=163,Fn.p=function(t,e){46===t.token&&e.addNextState(zn)},Fn.id=164,Bn.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Un),58===n&&e.addNextState(Jn)},Bn.id=165,Un.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Un),58===n&&e.addNextState(Jn)},Un.id=166,Jn.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ln),t.startCall("EXPR^1").addReturn(e.context,Vn)},Jn.id=167,Ln.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ln),t.startCall("EXPR^1").addReturn(e.context,Vn)},Ln.id=168,Vn.p=function(t,e){t.returnCall("OBJECT_PAIR",e)},Vn.id=169,Hn.p=function(t,e){t.returnCall("OBJECT_PAIR",e)},Hn.id=170,Yn.p=function(t,e){46===t.token&&e.addNextState(qn)},Yn.id=171,qn.p=function(t,e){46===t.token&&e.addNextState($n)},qn.id=172,$n.p=function(t,e){t.returnCall("OBJECT_PAIR",e)},$n.id=173,zn.p=function(t,e){46===t.token&&e.addNextState(Zn)},zn.id=174,Zn.p=function(t,e){46===t.token&&e.addNextState(Qn)},Zn.id=175,Qn.p=function(t,e){t.startCall("IGN").addReturn(e.context,Kn),t.startCall("EXPR^1").addReturn(e.context,Wn)},Qn.id=176,Kn.p=function(t,e){t.startCall("IGN").addReturn(e.context,Kn),t.startCall("EXPR^1").addReturn(e.context,Wn)},Kn.id=177,Wn.p=function(t,e){t.returnCall("OBJECT_PAIR",e)},Wn.id=178,tr.p=function(t,e){t.addMark("pair",e.context,er),t.startCall("EXPR^2").addReturn(e.context,nr)},tr.id=179,er.p=function(t,e){t.startCall("EXPR^2").addReturn(e.context,rr)},er.id=180,nr.p=function(t,e){t.returnCall("EXPR^1",e)},nr.id=181,rr.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ar),61===n&&e.addNextState(dr)},rr.id=182,ar.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ar),61===n&&e.addNextState(dr)},ar.id=183,dr.p=function(t,e){62===t.token&&e.addNextState(ir)},dr.id=184,ir.p=function(t,e){t.startCall("IGN").addReturn(e.context,or),t.startCall("EXPR^2").addReturn(e.context,ur)},ir.id=185,or.p=function(t,e){t.startCall("IGN").addReturn(e.context,or),t.startCall("EXPR^2").addReturn(e.context,ur)},or.id=186,ur.p=function(t,e){t.returnCall("EXPR^1",e)},ur.id=187,lr.p=function(t,e){t.addMark("or",e.context,cr),t.startCall("EXPR^3").addReturn(e.context,sr)},lr.id=188,cr.p=function(t,e){t.startCall("EXPR^2").addReturn(e.context,pr)},cr.id=189,sr.p=function(t,e){t.returnCall("EXPR^2",e)},sr.id=190,pr.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,fr),124===n&&e.addNextState(xr)},pr.id=191,fr.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,fr),124===n&&e.addNextState(xr)},fr.id=192,xr.p=function(t,e){124===t.token&&e.addNextState(yr)},xr.id=193,yr.p=function(t,e){t.startCall("IGN").addReturn(e.context,wr),t.startCall("EXPR^3").addReturn(e.context,Rr)},yr.id=194,wr.p=function(t,e){t.startCall("IGN").addReturn(e.context,wr),t.startCall("EXPR^3").addReturn(e.context,Rr)},wr.id=195,Rr.p=function(t,e){t.returnCall("EXPR^2",e)},Rr.id=196,Cr.p=function(t,e){t.addMark("and",e.context,Nr),t.startCall("EXPR^4").addReturn(e.context,vr)},Cr.id=197,Nr.p=function(t,e){t.startCall("EXPR^3").addReturn(e.context,hr)},Nr.id=198,vr.p=function(t,e){t.returnCall("EXPR^3",e)},vr.id=199,hr.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Sr),38===n&&e.addNextState(Er)},hr.id=200,Sr.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Sr),38===n&&e.addNextState(Er)},Sr.id=201,Er.p=function(t,e){38===t.token&&e.addNextState(kr)},Er.id=202,kr.p=function(t,e){t.startCall("IGN").addReturn(e.context,gr),t.startCall("EXPR^4").addReturn(e.context,Ir)},kr.id=203,gr.p=function(t,e){t.startCall("IGN").addReturn(e.context,gr),t.startCall("EXPR^4").addReturn(e.context,Ir)},gr.id=204,Ir.p=function(t,e){t.returnCall("EXPR^3",e)},Ir.id=205,Pr.p=function(t,e){t.addMark("comp",e.context,Gr),t.addMark("asc",e.context,Tr),t.addMark("desc",e.context,br),t.startCall("EXPR^5").addReturn(e.context,mr)},Pr.id=206,Gr.p=function(t,e){t.startCall("EXPR^5").addReturn(e.context,Xr)},Gr.id=207,Tr.p=function(t,e){t.startCall("EXPR^4").addReturn(e.context,Fr)},Tr.id=208,br.p=function(t,e){t.startCall("EXPR^4").addReturn(e.context,Vr)},br.id=209,mr.p=function(t,e){t.returnCall("EXPR^4",e)},mr.id=210,Xr.p=function(t,e){t.startCall("IGN").addReturn(e.context,_r),t.addMark("op",e.context,Mr)},Xr.id=211,_r.p=function(t,e){t.startCall("IGN").addReturn(e.context,_r),t.addMark("op",e.context,Mr)},_r.id=212,Mr.p=function(t,e){t.startCall("COMP_OP").addReturn(e.context,Ar)},Mr.id=213,Ar.p=function(t,e){t.addMark("end",e.context,Or)},Ar.id=214,Or.p=function(t,e){t.startCall("IGN").addReturn(e.context,Dr),t.startCall("EXPR^5").addReturn(e.context,jr)},Or.id=215,Dr.p=function(t,e){t.startCall("IGN").addReturn(e.context,Dr),t.startCall("EXPR^5").addReturn(e.context,jr)},Dr.id=216,jr.p=function(t,e){t.returnCall("EXPR^4",e)},jr.id=217,Fr.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Br),97===n&&e.addNextState(Ur)},Fr.id=218,Br.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Br),97===n&&e.addNextState(Ur)},Br.id=219,Ur.p=function(t,e){115===t.token&&e.addNextState(Jr)},Ur.id=220,Jr.p=function(t,e){99===t.token&&e.addNextState(Lr)},Jr.id=221,Lr.p=function(t,e){t.returnCall("EXPR^4",e)},Lr.id=222,Vr.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Hr),100===n&&e.addNextState(Yr)},Vr.id=223,Hr.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Hr),100===n&&e.addNextState(Yr)},Hr.id=224,Yr.p=function(t,e){101===t.token&&e.addNextState(qr)},Yr.id=225,qr.p=function(t,e){115===t.token&&e.addNextState($r)},qr.id=226,$r.p=function(t,e){99===t.token&&e.addNextState(zr)},$r.id=227,zr.p=function(t,e){t.returnCall("EXPR^4",e)},zr.id=228,Zr.p=function(t,e){t.addMark("inc_range",e.context,Qr),t.addMark("exc_range",e.context,Kr),t.startCall("EXPR^6").addReturn(e.context,Wr)},Zr.id=229,Qr.p=function(t,e){t.startCall("EXPR^6").addReturn(e.context,ta)},Qr.id=230,Kr.p=function(t,e){t.startCall("EXPR^6").addReturn(e.context,ia)},Kr.id=231,Wr.p=function(t,e){t.returnCall("EXPR^5",e)},Wr.id=232,ta.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ea),46===n&&e.addNextState(na)},ta.id=233,ea.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ea),46===n&&e.addNextState(na)},ea.id=234,na.p=function(t,e){46===t.token&&e.addNextState(ra)},na.id=235,ra.p=function(t,e){t.startCall("IGN").addReturn(e.context,aa),t.startCall("EXPR^6").addReturn(e.context,da)},ra.id=236,aa.p=function(t,e){t.startCall("IGN").addReturn(e.context,aa),t.startCall("EXPR^6").addReturn(e.context,da)},aa.id=237,da.p=function(t,e){t.returnCall("EXPR^5",e)},da.id=238,ia.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,oa),46===n&&e.addNextState(ua)},ia.id=239,oa.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,oa),46===n&&e.addNextState(ua)},oa.id=240,ua.p=function(t,e){46===t.token&&e.addNextState(la)},ua.id=241,la.p=function(t,e){46===t.token&&e.addNextState(ca)},la.id=242,ca.p=function(t,e){t.startCall("IGN").addReturn(e.context,sa),t.startCall("EXPR^6").addReturn(e.context,pa)},ca.id=243,sa.p=function(t,e){t.startCall("IGN").addReturn(e.context,sa),t.startCall("EXPR^6").addReturn(e.context,pa)},sa.id=244,pa.p=function(t,e){t.returnCall("EXPR^5",e)},pa.id=245,fa.p=function(t,e){t.addMark("add",e.context,xa),t.addMark("sub",e.context,ya),t.startCall("EXPR^7").addReturn(e.context,wa)},fa.id=246,xa.p=function(t,e){t.startCall("EXPR^6").addReturn(e.context,Ra)},xa.id=247,ya.p=function(t,e){t.startCall("EXPR^6").addReturn(e.context,Sa)},ya.id=248,wa.p=function(t,e){t.returnCall("EXPR^6",e)},wa.id=249,Ra.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Ca),43===n&&e.addNextState(Na)},Ra.id=250,Ca.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Ca),43===n&&e.addNextState(Na)},Ca.id=251,Na.p=function(t,e){t.startCall("IGN").addReturn(e.context,va),t.startCall("EXPR^7").addReturn(e.context,ha)},Na.id=252,va.p=function(t,e){t.startCall("IGN").addReturn(e.context,va),t.startCall("EXPR^7").addReturn(e.context,ha)},va.id=253,ha.p=function(t,e){t.returnCall("EXPR^6",e)},ha.id=254,Sa.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Ea),45===n&&e.addNextState(ka)},Sa.id=255,Ea.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Ea),45===n&&e.addNextState(ka)},Ea.id=256,ka.p=function(t,e){t.startCall("IGN").addReturn(e.context,ga),t.startCall("EXPR^7").addReturn(e.context,Ia)},ka.id=257,ga.p=function(t,e){t.startCall("IGN").addReturn(e.context,ga),t.startCall("EXPR^7").addReturn(e.context,Ia)},ga.id=258,Ia.p=function(t,e){t.returnCall("EXPR^6",e)},Ia.id=259,Pa.p=function(t,e){t.addMark("mul",e.context,Ga),t.addMark("div",e.context,Ta),t.addMark("mod",e.context,ba),t.startCall("EXPR^9").addReturn(e.context,ma)},Pa.id=260,Ga.p=function(t,e){t.startCall("EXPR^7").addReturn(e.context,Xa)},Ga.id=261,Ta.p=function(t,e){t.startCall("EXPR^7").addReturn(e.context,Da)},Ta.id=262,ba.p=function(t,e){t.startCall("EXPR^7").addReturn(e.context,Ja)},ba.id=263,ma.p=function(t,e){t.returnCall("EXPR^7",e)},ma.id=264,Xa.p=function(t,e){t.startCall("IGN").addReturn(e.context,_a),t.startCall("STAR").addReturn(e.context,Ma)},Xa.id=265,_a.p=function(t,e){t.startCall("IGN").addReturn(e.context,_a),t.startCall("STAR").addReturn(e.context,Ma)},_a.id=266,Ma.p=function(t,e){t.startCall("IGN").addReturn(e.context,Aa),t.startCall("EXPR^9").addReturn(e.context,Oa)},Ma.id=267,Aa.p=function(t,e){t.startCall("IGN").addReturn(e.context,Aa),t.startCall("EXPR^9").addReturn(e.context,Oa)},Aa.id=268,Oa.p=function(t,e){t.returnCall("EXPR^7",e)},Oa.id=269,Da.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ja),47===n&&e.addNextState(Fa)},Da.id=270,ja.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ja),47===n&&e.addNextState(Fa)},ja.id=271,Fa.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ba),t.startCall("EXPR^9").addReturn(e.context,Ua)},Fa.id=272,Ba.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ba),t.startCall("EXPR^9").addReturn(e.context,Ua)},Ba.id=273,Ua.p=function(t,e){t.returnCall("EXPR^7",e)},Ua.id=274,Ja.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,La),37===n&&e.addNextState(Va)},Ja.id=275,La.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,La),37===n&&e.addNextState(Va)},La.id=276,Va.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ha),t.startCall("EXPR^9").addReturn(e.context,Ya)},Va.id=277,Ha.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ha),t.startCall("EXPR^9").addReturn(e.context,Ya)},Ha.id=278,Ya.p=function(t,e){t.returnCall("EXPR^7",e)},Ya.id=279,qa.p=function(t,e){t.addMark("pow",e.context,$a),t.startCall("EXPR^11").addReturn(e.context,za)},qa.id=280,$a.p=function(t,e){t.startCall("EXPR^11").addReturn(e.context,Za)},$a.id=281,za.p=function(t,e){t.returnCall("EXPR^9",e)},za.id=282,Za.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Qa),42===n&&e.addNextState(Ka)},Za.id=283,Qa.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Qa),42===n&&e.addNextState(Ka)},Qa.id=284,Ka.p=function(t,e){42===t.token&&e.addNextState(Wa)},Ka.id=285,Wa.p=function(t,e){t.startCall("IGN").addReturn(e.context,td),t.startCall("EXPR^9").addReturn(e.context,ed)},Wa.id=286,td.p=function(t,e){t.startCall("IGN").addReturn(e.context,td),t.startCall("EXPR^9").addReturn(e.context,ed)},td.id=287,ed.p=function(t,e){t.returnCall("EXPR^9",e)},ed.id=288,nd.p=function(t,e){var n=t.token;t.startCall("NUMBER").addReturn(e.context,rd),t.startCall("STRING").addReturn(e.context,ad),t.startCall("ARRAY").addReturn(e.context,dd),t.startCall("OBJECT").addReturn(e.context,id),t.addMark("star",e.context,od),t.addMark("this",e.context,ud),t.startCall("PARENT").addReturn(e.context,ld),t.addMark("paren",e.context,cd),36===n&&e.addNextState(sd),t.addMark("ident",e.context,pd),t.startCall("FUNC_CALL").addReturn(e.context,fd),t.addMark("neg",e.context,xd),t.addMark("pos",e.context,yd),t.addMark("not",e.context,wd),105===n&&e.addNextState(Rd),t.addMark("deref",e.context,Cd),t.addMark("attr_cond",e.context,Nd),t.addMark("attr_ident",e.context,vd),t.addMark("pipecall",e.context,hd),t.addMark("project",e.context,Sd),t.addMark("filter",e.context,Ed),t.addMark("arr_expr",e.context,kd)},nd.id=289,rd.p=function(t,e){t.returnCall("EXPR^11",e)},rd.id=290,ad.p=function(t,e){t.returnCall("EXPR^11",e)},ad.id=291,dd.p=function(t,e){t.returnCall("EXPR^11",e)},dd.id=292,id.p=function(t,e){t.returnCall("EXPR^11",e)},id.id=293,od.p=function(t,e){t.startCall("STAR").addReturn(e.context,gd)},od.id=294,ud.p=function(t,e){64===t.token&&e.addNextState(Id)},ud.id=295,ld.p=function(t,e){t.returnCall("EXPR^11",e)},ld.id=296,cd.p=function(t,e){40===t.token&&e.addNextState(Pd)},cd.id=297,sd.p=function(t,e){t.addMark("param",e.context,Xd)},sd.id=298,pd.p=function(t,e){t.startCall("IDENT").addReturn(e.context,Ad)},pd.id=299,fd.p=function(t,e){t.returnCall("EXPR^11",e)},fd.id=300,xd.p=function(t,e){45===t.token&&e.addNextState(Dd)},xd.id=301,yd.p=function(t,e){43===t.token&&e.addNextState(Bd)},yd.id=302,wd.p=function(t,e){33===t.token&&e.addNextState(Ld)},wd.id=303,Rd.p=function(t,e){115===t.token&&e.addNextState(Yd)},Rd.id=304,Cd.p=function(t,e){t.startCall("EXPR^11").addReturn(e.context,zd)},Cd.id=305,Nd.p=function(t,e){t.startCall("EXPR^11").addReturn(e.context,ni)},Nd.id=306,vd.p=function(t,e){t.startCall("EXPR^11").addReturn(e.context,si)},vd.id=307,hd.p=function(t,e){t.startCall("EXPR^11").addReturn(e.context,Ri)},hd.id=308,Sd.p=function(t,e){t.startCall("EXPR^11").addReturn(e.context,hi)},Sd.id=309,Ed.p=function(t,e){t.startCall("EXPR^11").addReturn(e.context,gi)},Ed.id=310,kd.p=function(t,e){t.startCall("EXPR^11").addReturn(e.context,_i)},kd.id=311,gd.p=function(t,e){t.returnCall("EXPR^11",e)},gd.id=312,Id.p=function(t,e){t.returnCall("EXPR^11",e)},Id.id=313,Pd.p=function(t,e){t.startCall("IGN").addReturn(e.context,Gd),t.startCall("EXPR^1").addReturn(e.context,Td)},Pd.id=314,Gd.p=function(t,e){t.startCall("IGN").addReturn(e.context,Gd),t.startCall("EXPR^1").addReturn(e.context,Td)},Gd.id=315,Td.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,bd),41===n&&e.addNextState(md)},Td.id=316,bd.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,bd),41===n&&e.addNextState(md)},bd.id=317,md.p=function(t,e){t.returnCall("EXPR^11",e)},md.id=318,Xd.p=function(t,e){t.startCall("IDENT").addReturn(e.context,_d)},Xd.id=319,_d.p=function(t,e){t.addMark("param_end",e.context,Md)},_d.id=320,Md.p=function(t,e){t.returnCall("EXPR^11",e)},Md.id=321,Ad.p=function(t,e){t.addMark("ident_end",e.context,Od)},Ad.id=322,Od.p=function(t,e){t.returnCall("EXPR^11",e)},Od.id=323,Dd.p=function(t,e){t.startCall("IGN").addReturn(e.context,jd),t.startCall("EXPR^9").addReturn(e.context,Fd)},Dd.id=324,jd.p=function(t,e){t.startCall("IGN").addReturn(e.context,jd),t.startCall("EXPR^9").addReturn(e.context,Fd)},jd.id=325,Fd.p=function(t,e){t.returnCall("EXPR^11",e)},Fd.id=326,Bd.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ud),t.startCall("EXPR^11").addReturn(e.context,Jd)},Bd.id=327,Ud.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ud),t.startCall("EXPR^11").addReturn(e.context,Jd)},Ud.id=328,Jd.p=function(t,e){t.returnCall("EXPR^11",e)},Jd.id=329,Ld.p=function(t,e){t.startCall("IGN").addReturn(e.context,Vd),t.startCall("EXPR^11").addReturn(e.context,Hd)},Ld.id=330,Vd.p=function(t,e){t.startCall("IGN").addReturn(e.context,Vd),t.startCall("EXPR^11").addReturn(e.context,Hd)},Vd.id=331,Hd.p=function(t,e){t.returnCall("EXPR^11",e)},Hd.id=332,Yd.p=function(t,e){t.startCall("IGN").addReturn(e.context,qd),t.startCall("EXPR^11").addReturn(e.context,$d)},Yd.id=333,qd.p=function(t,e){t.startCall("IGN").addReturn(e.context,qd),t.startCall("EXPR^11").addReturn(e.context,$d)},qd.id=334,$d.p=function(t,e){t.returnCall("EXPR^11",e)},$d.id=335,zd.p=function(t,e){45===t.token&&e.addNextState(Zd)},zd.id=336,Zd.p=function(t,e){62===t.token&&e.addNextState(Qd)},Zd.id=337,Qd.p=function(t,e){t.startCall("IGN").addReturn(e.context,Kd),t.addMark("deref_field",e.context,Wd),t.returnCall("EXPR^11",e)},Qd.id=338,Kd.p=function(t,e){t.startCall("IGN").addReturn(e.context,Kd),t.addMark("deref_field",e.context,Wd)},Kd.id=339,Wd.p=function(t,e){t.startCall("IDENT").addReturn(e.context,ti)},Wd.id=340,ti.p=function(t,e){t.addMark("end",e.context,ei)},ti.id=341,ei.p=function(t,e){t.returnCall("EXPR^11",e)},ei.id=342,ni.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ri),46===n&&e.addNextState(ai)},ni.id=343,ri.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,ri),46===n&&e.addNextState(ai)},ri.id=344,ai.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,di),91===n&&e.addNextState(ii)},ai.id=345,di.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,di),91===n&&e.addNextState(ii)},di.id=346,ii.p=function(t,e){t.startCall("IGN").addReturn(e.context,oi),t.startCall("EXPR^1").addReturn(e.context,ui)},ii.id=347,oi.p=function(t,e){t.startCall("IGN").addReturn(e.context,oi),t.startCall("EXPR^1").addReturn(e.context,ui)},oi.id=348,ui.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,li),93===n&&e.addNextState(ci)},ui.id=349,li.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,li),93===n&&e.addNextState(ci)},li.id=350,ci.p=function(t,e){t.returnCall("EXPR^11",e)},ci.id=351,si.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,pi),46===n&&e.addNextState(fi)},si.id=352,pi.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,pi),46===n&&e.addNextState(fi)},pi.id=353,fi.p=function(t,e){t.addMark("ident",e.context,xi)},fi.id=354,xi.p=function(t,e){t.startCall("IDENT").addReturn(e.context,yi)},xi.id=355,yi.p=function(t,e){t.addMark("ident_end",e.context,wi)},yi.id=356,wi.p=function(t,e){t.returnCall("EXPR^11",e)},wi.id=357,Ri.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ci),t.startCall("PIPE").addReturn(e.context,Ni)},Ri.id=358,Ci.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ci),t.startCall("PIPE").addReturn(e.context,Ni)},Ci.id=359,Ni.p=function(t,e){t.startCall("FUNC_CALL").addReturn(e.context,vi)},Ni.id=360,vi.p=function(t,e){t.returnCall("EXPR^11",e)},vi.id=361,hi.p=function(t,e){t.startCall("IGN").addReturn(e.context,Si),t.startCall("PIPE").addReturn(e.context,Ei),t.startCall("OBJECT").addReturn(e.context,ki)},hi.id=362,Si.p=function(t,e){t.startCall("IGN").addReturn(e.context,Si),t.startCall("PIPE").addReturn(e.context,Ei),t.startCall("OBJECT").addReturn(e.context,ki)},Si.id=363,Ei.p=function(t,e){t.startCall("OBJECT").addReturn(e.context,ki)},Ei.id=364,ki.p=function(t,e){t.returnCall("EXPR^11",e)},ki.id=365,gi.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Ii),t.startCall("PIPE").addReturn(e.context,Pi),91===n&&e.addNextState(Gi)},gi.id=366,Ii.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Ii),t.startCall("PIPE").addReturn(e.context,Pi),91===n&&e.addNextState(Gi)},Ii.id=367,Pi.p=function(t,e){91===t.token&&e.addNextState(Gi)},Pi.id=368,Gi.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ti),t.startCall("EXPR^1").addReturn(e.context,bi)},Gi.id=369,Ti.p=function(t,e){t.startCall("IGN").addReturn(e.context,Ti),t.startCall("EXPR^1").addReturn(e.context,bi)},Ti.id=370,bi.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,mi),93===n&&e.addNextState(Xi)},bi.id=371,mi.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,mi),93===n&&e.addNextState(Xi)},mi.id=372,Xi.p=function(t,e){t.returnCall("EXPR^11",e)},Xi.id=373,_i.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Mi),t.startCall("PIPE").addReturn(e.context,Ai),91===n&&e.addNextState(Oi)},_i.id=374,Mi.p=function(t,e){var n=t.token;t.startCall("IGN").addReturn(e.context,Mi),t.startCall("PIPE").addReturn(e.context,Ai),91===n&&e.addNextState(Oi)},Mi.id=375,Ai.p=function(t,e){91===t.token&&e.addNextState(Oi)},Ai.id=376,Oi.p=function(t,e){93===t.token&&e.addNextState(Di)},Oi.id=377,Di.p=function(t,e){t.returnCall("EXPR^11",e)},Di.id=378;var ji=new X(new m(null,null));ji.addNextState(O);var Fi=[ji],Bi={};function Ui(t){return"Value"===t.type}function Ji(t){return Ui(t)&&"number"==typeof t.value}Bi.main=[j],Bi.SPACE=[J],Bi.COMMENT=[Q],Bi.COMMENT_END=[rt],Bi.IGN=[dt],Bi.PIPE=[ut],Bi.PARENT=[st],Bi.IDENT_FST=[Ct],Bi.IDENT_REST=[St],Bi.IDENT=[gt],Bi.STAR=[Gt],Bi.COMP_OP=[bt],Bi.FUNC_CALL=[$t],Bi.FUNC_ARGS=[ae],Bi.NUMBER=[se],Bi.DIGIT=[Te],Bi.SIGN=[me],Bi.STRING=[Me],Bi.DSTRING_CHAR=[He],Bi.SSTRING_CHAR=[ze],Bi.ARRAY=[We],Bi.ARRAY_ELEMENT=[xn],Bi.OBJECT=[hn],Bi.OBJECT_PAIR=[An],Bi["EXPR^1"]=[tr],Bi["EXPR^2"]=[lr],Bi["EXPR^3"]=[Cr],Bi["EXPR^4"]=[Pr],Bi["EXPR^5"]=[Zr],Bi["EXPR^6"]=[fa],Bi["EXPR^7"]=[Pa],Bi["EXPR^9"]=[qa],Bi["EXPR^11"]=[nd];var Li={"'":"'",'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function Vi(t){var e=parseInt(t,16);return String.fromCharCode(e)}class Hi extends Error{}var Yi={paren:t=>({type:"Parenthesis",base:t.process()}),filter(t){var e,n=t.process(),r=t.process();return Ji(r)?{type:"Element",base:n,index:r}:Ui(e=r)&&"string"==typeof e.value?{type:"Attribute",base:n,name:r.value}:"Range"===r.type?{type:"Slice",base:n,left:r.left,right:r.right,isExclusive:r.isExclusive}:{type:"Filter",base:n,query:r}},project:t=>({type:"Projection",base:t.process(),query:t.process()}),star:()=>({type:"Star"}),this:()=>({type:"This"}),parent:()=>({type:"Parent",n:1}),dblparent:t=>({type:"Parent",n:t.process().n+1}),ident(t){var e=t.processStringEnd();return"null"===e?{type:"Value",value:null}:"true"===e?{type:"Value",value:!0}:"false"===e?{type:"Value",value:!1}:{type:"Identifier",name:e}},attr_ident:t=>({type:"Attribute",base:t.process(),name:t.processString()}),arr_expr:t=>({type:"Mapper",base:t.process()}),inc_range:t=>({type:"Range",left:t.process(),right:t.process(),isExclusive:!1}),exc_range:t=>({type:"Range",left:t.process(),right:t.process(),isExclusive:!0}),neg(t){var e=t.process();return"Value"===e.type&&"number"==typeof e.value?{type:"Value",value:-e.value}:{type:"Neg",base:e}},pos(t){var e=t.process();return Ji(e)?{type:"Value",value:+e.value}:{type:"Pos",base:e}},add:t=>({type:"OpCall",op:"+",left:t.process(),right:t.process()}),sub:t=>({type:"OpCall",op:"-",left:t.process(),right:t.process()}),mul:t=>({type:"OpCall",op:"*",left:t.process(),right:t.process()}),div:t=>({type:"OpCall",op:"/",left:t.process(),right:t.process()}),mod:t=>({type:"OpCall",op:"%",left:t.process(),right:t.process()}),pow:t=>({type:"OpCall",op:"**",left:t.process(),right:t.process()}),deref(t){var e=t.process(),n=t.getMark(),r={type:"Deref",base:e};return n&&"deref_field"===n.name?{type:"Attribute",base:r,name:t.processString()}:r},comp(t){var e=t.process();return{type:"OpCall",op:t.processString(),left:e,right:t.process()}},str_begin:t=>({type:"Value",value:t.processStringEnd().replace(/\\(['"/\\bfnrt]|u([A-Fa-f0-9]{4})|u\{([A-Fa-f0-9]+)\})/g,(t,e,n,r)=>n?Vi(n):r?Vi(r):Li[e])}),integer(t){var e=t.processStringEnd();return{type:"Value",value:Number(e)}},float(t){var e=t.processStringEnd();return{type:"Value",value:Number(e)}},sci(t){var e=t.processStringEnd();return{type:"Value",value:Number(e)}},pair:t=>({type:"Pair",left:t.process(),right:t.process()}),object(t){for(var e=[];"object_end"!==t.getMark().name;)e.push(t.process());return t.shift(),{type:"Object",attributes:e}},object_expr(t){var e=t.process();return"Pair"===e.type?{type:"ObjectConditionalSplat",condition:e.left,value:e.right}:{type:"ObjectAttribute",key:{type:"Value",value:$i(e)},value:e}},object_pair:t=>({type:"ObjectAttribute",key:t.process(),value:t.process()}),object_splat:t=>({type:"ObjectSplat",value:t.process()}),object_splat_this:()=>({type:"ObjectSplat",value:{type:"This"}}),array(t){for(var e=[];"array_end"!==t.getMark().name;){var n=!1;"array_splat"===t.getMark().name&&(n=!0,t.shift());var r=t.process();e.push({type:"ArrayElement",value:r,isSplat:n})}return t.shift(),{type:"Array",elements:e}},func_call(t){for(var e=t.processStringEnd(),n=[];"func_args_end"!==t.getMark().name;)n.push(t.process());t.shift();var r=I[e];if(!r)throw new Hi("Undefined function: "+e);return zi(e,r.arity,n.length),{type:"FuncCall",func:r,name:e,args:n}},pipecall(t){for(var e=t.process(),n=t.processString(),r=[];;){var a=t.getMark().name;if("func_args_end"===a)break;if("order"===n){if("asc"===a){t.shift(),r.push({type:"Asc",base:t.process()});continue}if("desc"===a){t.shift(),r.push({type:"Desc",base:t.process()});continue}}r.push(t.process())}t.shift();var d=P[n];if(!d)throw new Hi("Undefined pipe function: "+n);return zi(n,d.arity,r.length),{type:"PipeFuncCall",func:d,base:e,name:d.name,args:r}},and:t=>({type:"And",left:t.process(),right:t.process()}),or:t=>({type:"Or",left:t.process(),right:t.process()}),not:t=>({type:"Not",base:t.process()}),asc(t){throw new Hi("unexpected asc")},desc(t){throw new Hi("unexpected desc")},param:t=>({type:"Parameter",name:t.processStringEnd()})},qi=["Deref","Projection","Mapper","Filter","Element","Slice"];function $i(t){if("Identifier"===t.type)return t.name;if(function(t){return qi.includes(t.type)}(t))return $i(t.base);throw new Hi("Cannot determine property key for type: "+t.type)}function zi(t,e,n){if("number"==typeof e){if(n!==e)throw new Hi("Incorrect number of arguments to function "+t+"(). Expected "+e+", got "+n+".")}else if(e&&!e(n))throw new Hi("Incorrect number of arguments to function "+t+"().")}class Zi extends Error{constructor(t){super("Syntax error in GROQ query at position "+t),this.name="GroqSyntaxError",this.position=t}}var Qi=function(t,e){return Ki.apply(this,arguments)};function Ki(){return(Ki=o((function*(t,e){var n=t.getType();return n===e.getType()&&("number"===n||"string"===n||"boolean"===n||"null"===n)&&(yield t.get())===(yield e.get())}))).apply(this,arguments)}function Wi(t,e){return to.apply(this,arguments)}function to(){return(to=o((function*(t,n){switch(t.getType()){case"string":return n(yield t.get()),!0;case"array":var r,a=!0,d=!0,i=!1;try{for(var o,u,l=e(t);d=(o=yield l.next()).done,u=yield o.value,!d;d=!0){var c=u;"string"===c.getType()?n(yield c.get()):a=!1}}catch(t){i=!0,r=t}finally{try{d||null==l.return||(yield l.return())}finally{if(i)throw r}}return a;default:return!1}}))).apply(this,arguments)}var eo={"==":function(){var t=o((function*(t,e,n,r){var a=yield r(t,n),d=yield r(e,n);return(yield Qi(a,d))?x:y}));return function(e,n,r,a){return t.apply(this,arguments)}}(),"!=":function(){var t=o((function*(t,e,n,r){var a=yield r(t,n),d=yield r(e,n);return(yield Qi(a,d))?y:x}));return function(e,n,r,a){return t.apply(this,arguments)}}(),">":function(){var t=o((function*(t,e,n,r){var a=k(yield(yield r(t,n)).get(),yield(yield r(e,n)).get());return null===a?f:a>0?x:y}));return function(e,n,r,a){return t.apply(this,arguments)}}(),">=":function(){var t=o((function*(t,e,n,r){var a=k(yield(yield r(t,n)).get(),yield(yield r(e,n)).get());return null===a?f:a>=0?x:y}));return function(e,n,r,a){return t.apply(this,arguments)}}(),"<":function(){var t=o((function*(t,e,n,r){var a=k(yield(yield r(t,n)).get(),yield(yield r(e,n)).get());return null===a?f:a<0?x:y}));return function(e,n,r,a){return t.apply(this,arguments)}}(),"<=":function(){var t=o((function*(t,e,n,r){var a=k(yield(yield r(t,n)).get(),yield(yield r(e,n)).get());return null===a?f:a<=0?x:y}));return function(e,n,r,a){return t.apply(this,arguments)}}(),in:function(){var t=o((function*(t,n,r,a){var d=yield a(t,r),i=yield a(n,r);switch(i.getType()){case"array":var o,u=!0,l=!1;try{for(var c,s,p=e(i);u=(c=yield p.next()).done,s=yield c.value,!u;u=!0){var w=s;if(yield Qi(d,w))return x}}catch(t){l=!0,o=t}finally{try{u||null==p.return||(yield p.return())}finally{if(l)throw o}}return y;case"range":var R=yield d.get(),C=yield i.get(),N=k(R,C.left);if(null===N)return f;var v=k(R,C.right);return null===v?f:C.isExclusive()?N>=0&&v<0?x:y:N>=0&&v<=0?x:y;case"path":if("string"!==d.getType())return f;var h=yield d.get();return(yield i.get()).matches(h)?x:y}return f}));return function(e,n,r,a){return t.apply(this,arguments)}}(),match:function(){var t=o((function*(t,e,n,r){var a=yield r(t,n),d=yield r(e,n),i=[],o=[];return yield Wi(a,t=>{i=i.concat(function(t){return t.match(/[A-Za-z0-9]+/g)}(t))}),(yield Wi(d,t=>{o=o.concat(function(t){var e=(t.match(/[A-Za-z0-9*]+/g)||[]).map(t=>new RegExp("^"+t.replace(/\*/g,".*")+"$","i"));return t=>e.every(e=>t.some(t=>e.test(t)))}(t))}))&&function(t,e){return 0!==t.length&&0!==e.length&&e.every(e=>e(t))}(i,o)?x:y}));return function(e,n,r,a){return t.apply(this,arguments)}}(),"+":function(){var t=o((function*(t,e,n,r){var a=yield r(t,n),d=yield r(e,n),i=a.getType(),o=d.getType();return"number"===i&&"number"===o||"string"===i&&"string"===o?new p((yield a.get())+(yield d.get())):"array"===i&&"array"===o?new p((yield a.get()).concat(yield d.get())):"object"===i&&"object"===o?new p(u({},yield a.get(),yield d.get())):f}));return function(e,n,r,a){return t.apply(this,arguments)}}(),"-":no((t,e)=>t-e),"*":no((t,e)=>t*e),"/":no((t,e)=>t/e),"%":no((t,e)=>t%e),"**":no((t,e)=>Math.pow(t,e))};function no(t){return function(){var e=o((function*(e,n,r,a){var d=yield a(e,r),i=yield a(n,r),o=d.getType(),u=i.getType();return"number"===o&&"number"===u?h(t(yield d.get(),yield i.get())):f}));return function(t,n,r,a){return e.apply(this,arguments)}}()}function ro(t,n){return t instanceof R?new R(new w(a((function*(){var r,a=!0,i=!1;try{for(var o,u,l=e(t);a=(o=yield d(l.next())).done,u=yield d(o.value),!a;a=!0){var c=u;yield n(c)}}catch(t){i=!0,r=t}finally{try{a||null==l.return||(yield d(l.return()))}finally{if(i)throw r}}})))):n(t)}class ao{constructor(t,e,n,r){this.params=t,this.source=e,this.value=n,this.parent=r,this.timestamp=r?r.timestamp:(new Date).toISOString()}createNested(t){return new ao(this.params,this.source,t,this)}}function io(t,e){if(void 0===oo[t.type])throw new Error("No executor for node.type="+t.type);return(0,oo[t.type])(t,e)}var oo={This:(t,e)=>e.value,Star:(t,e)=>e.source,Parameter:(t,e)=>S(e.params[t.name]),Parent(t,e){for(var n=e,r=0;r<t.n;r++){if(!n.parent)return f;n=n.parent}return n.value},OpCall(t,e){var n=t.op,r=t.left,a=t.right,d=eo[n];if(!d)throw new Error("Unknown operator: "+n);return d(r,a,e,io)},FuncCall:(t,e)=>(0,t.func)(t.args,e,io),PipeFuncCall:(t,e)=>o((function*(){var n=t.base,r=t.args;return(0,t.func)(yield io(n,e),r,e,io)}))(),Filter:(t,n)=>o((function*(){var r=t.base,i=t.query;return ro(yield io(r,n),function(){var t=o((function*(t){return"array"!==t.getType()?f:new w(a((function*(){var r,a=!0,o=!1;try{for(var u,l,c=e(t);a=(u=yield d(c.next())).done,l=yield d(u.value),!a;a=!0){var s=l,p=n.createNested(s);(yield d(io(i,p))).getBoolean()&&(yield s)}}catch(t){o=!0,r=t}finally{try{a||null==c.return||(yield d(c.return()))}finally{if(o)throw r}}})))}));return function(e){return t.apply(this,arguments)}}())}))(),Element:(t,e)=>o((function*(){var n=t.base,r=t.index;return ro(yield io(n,e),function(){var t=o((function*(t){if("array"!==t.getType())return f;var n=yield io(r,e);if("number"!==n.getType())return f;var a=yield t.get(),d=yield n.get();return d<0&&(d=a.length+d),d>=0&&d<a.length?new p(a[d]):f}));return function(e){return t.apply(this,arguments)}}())}))(),Slice:(t,e)=>o((function*(){var n=t.base,r=t.left,a=t.right,d=t.isExclusive;return ro(yield io(n,e),function(){var t=o((function*(t){if("array"!==t.getType())return f;var n=yield io(r,e),i=yield io(a,e);if("number"!==n.getType()||"number"!==i.getType())return f;var o=yield t.get(),u=yield n.get(),l=yield i.get();return u<0&&(u=o.length+u),l<0&&(l=o.length+l),d||l++,u<0&&(u=0),l<0&&(l=0),new p(o.slice(u,l))}));return function(e){return t.apply(this,arguments)}}())}))(),Attribute:(t,e)=>o((function*(){var n=t.base,r=t.name;return ro(yield io(n,e),function(){var t=o((function*(t){if("object"===t.getType()){var e=yield t.get();if(e.hasOwnProperty(r))return new p(e[r])}return f}));return function(e){return t.apply(this,arguments)}}())}))(),Identifier:(t,e)=>o((function*(){var n=t.name;if("object"===e.value.getType()){var r=yield e.value.get();if(r.hasOwnProperty(n))return new p(r[n])}return f}))(),Value:t=>new p(t.value),Mapper:(t,n)=>o((function*(){var r=t.base,i=yield io(r,n);return"array"!==i.getType()?i:new R(i instanceof R?new w(a((function*(){var t,n=!0,r=!1;try{for(var a,o,u=e(i);n=(a=yield d(u.next())).done,o=yield d(a.value),!n;n=!0){var l=o;if("array"===l.getType()){var c,s=!0,p=!1;try{for(var x,y,w=e(l);s=(x=yield d(w.next())).done,y=yield d(x.value),!s;s=!0){var R=y;yield R}}catch(t){p=!0,c=t}finally{try{s||null==w.return||(yield d(w.return()))}finally{if(p)throw c}}}else yield f}}catch(e){r=!0,t=e}finally{try{n||null==u.return||(yield d(u.return()))}finally{if(r)throw t}}}))):i)}))(),Parenthesis:(t,e)=>o((function*(){var n=t.base,r=yield io(n,e);return r instanceof R&&(r=r.value),r}))(),Projection:(t,n)=>o((function*(){var r=t.base,i=t.query,o=yield io(r,n);if("null"===o.getType())return f;if("array"===o.getType())return new w(a((function*(){var t,r=!0,a=!1;try{for(var u,l,c=e(o);r=(u=yield d(c.next())).done,l=yield d(u.value),!r;r=!0){var s=n.createNested(l),p=yield d(io(i,s));yield p}}catch(e){a=!0,t=e}finally{try{r||null==c.return||(yield d(c.return()))}finally{if(a)throw t}}})));var u=n.createNested(o);return yield io(i,u)}))(),Deref:(t,n)=>o((function*(){var r=t.base;return ro(yield io(r,n),function(){var t=o((function*(t){if("array"!==n.source.getType())return f;if("object"!==t.getType())return f;var r=(yield t.get())._ref;if("string"!=typeof r)return f;var a,d=!0,i=!1;try{for(var o,u,l=e(n.source);d=(o=yield l.next()).done,u=yield o.value,!d;d=!0)if(r===u.data._id)return u}catch(t){i=!0,a=t}finally{try{d||null==l.return||(yield l.return())}finally{if(i)throw a}}return f}));return function(e){return t.apply(this,arguments)}}())}))(),Object:(t,e)=>o((function*(){for(var n,r={},a=c(t.attributes);!(n=a()).done;){var d=n.value,i=d.type;switch(d.type){case"ObjectAttribute":var o=yield io(d.key,e);if("string"!==o.getType())continue;var u=yield io(d.value,e);if("null"===u.getType()){delete r[o.data];break}r[o.data]=yield u.get();break;case"ObjectConditionalSplat":if(!(yield io(d.condition,e)).getBoolean())continue;var l=yield io(d.value,e);if("object"!==l.getType())continue;Object.assign(r,l.data);break;case"ObjectSplat":var s=yield io(d.value,e);s.getType("object")&&Object.assign(r,s.data);break;default:throw new Error("Unknown node type: "+i)}}return new p(r)}))(),Array(t,n){var r=t.elements;return new w(a((function*(){for(var t,a=c(r);!(t=a()).done;){var i=t.value,o=yield d(io(i.value,n));if(i.isSplat){if("array"===o.getType()){var u,l=!0,s=!1;try{for(var p,f,x=e(o);l=(p=yield d(x.next())).done,f=yield d(p.value),!l;l=!0){var y=f;yield y}}catch(t){s=!0,u=t}finally{try{l||null==x.return||(yield d(x.return()))}finally{if(s)throw u}}}}else yield o}})))},Range:(t,e)=>o((function*(){var n=t.left,r=t.right,a=t.isExclusive,d=yield io(n,e),i=yield io(r,e);if(!C.isConstructible(d.getType(),i.getType()))return f;var o=new C(yield d.get(),yield i.get(),a);return new p(o)}))(),Pair:(t,e)=>o((function*(){var n=t.left,r=t.right,a=yield io(n,e),d=yield io(r,e),i=new N(yield a.get(),yield d.get());return new p(i)}))(),Or:(t,e)=>o((function*(){var n=t.left,r=t.right,a=yield io(n,e),d=yield io(r,e);return"boolean"===a.getType()&&!0===a.data||"boolean"===d.getType()&&!0===d.data?x:"boolean"!==a.getType()||"boolean"!==d.getType()?f:y}))(),And:(t,e)=>o((function*(){var n=t.left,r=t.right,a=yield io(n,e),d=yield io(r,e);return"boolean"===a.getType()&&!1===a.data||"boolean"===d.getType()&&!1===d.data?y:"boolean"!==a.getType()||"boolean"!==d.getType()?f:x}))(),Not:(t,e)=>o((function*(){var n=t.base,r=yield io(n,e);return"boolean"!==r.getType()?f:r.getBoolean()?y:x}))(),Neg:(t,e)=>o((function*(){var n=t.base,r=yield io(n,e);return"number"!==r.getType()?f:h(-(yield r.get()))}))(),Pos:(t,e)=>o((function*(){var n=t.base,r=yield io(n,e);return"number"!==r.getType()?f:h(yield r.get())}))(),Asc:()=>o((function*(){return f}))(),Desc:()=>o((function*(){return f}))()};function uo(){return(uo=o((function*(t,e){void 0===e&&(e={});var n=S(e.root),r=S(e.dataset),a=u({},e.params),d=new ao(a,r,n,null);return yield io(t,d)}))).apply(this,arguments)}exports.evaluate=function(t,e){return uo.apply(this,arguments)},exports.parse=function(e){var n=function(t){for(var e=Fi,n=0;n<t.length;n++){var r=_(t.charCodeAt(n),n,e);if(!r.hasNextFrames())return{type:"error",position:n};e=r.nextFrames}return(r=_(null,n,e)).wasAccepted()?{type:"success",marks:function(t){if(!t)return[];for(var e=[t],n=[];e.length;){var r=e.shift();if("concat"===r.type)e.unshift(r.left,r.right);else{if("mark"!==r.type)throw new Error("unknown mark type: "+r.type);n.push(r)}}return n}(r.acceptedContexts[0].marks)}:{type:"error",position:n}}(e);if("error"===n.type)throw new Zi(n.position);return new t(Yi,e,n.marks).process()};
//# sourceMappingURL=groq-js.cjs.production.min.js.map
