"use strict";

var ConfigStore = require('configstore');

var client = require('part:@sanity/base/client?');

if (!client) {
  throw new Error('--with-user-token specified, but @sanity/base is not a plugin in this project');
} // eslint-disable-next-line no-process-env


var sanityEnv = (process.env.SANITY_INTERNAL_ENV || '').toLowerCase();
var defaults = {};
var config = new ConfigStore(sanityEnv && sanityEnv !== 'production' ? "sanity-".concat(sanityEnv) : 'sanity', defaults, {
  globalConfigPath: true
});
var token = config.get('authToken');

if (!token) {
  throw new Error('--with-user-token specified, but no auth token could be found. Run `sanity login`');
} // Reconfigure client and silence the warning about configuring it globally


client.config({
  token
}, true);