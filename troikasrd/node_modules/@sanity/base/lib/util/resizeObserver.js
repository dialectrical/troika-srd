"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.resizeObserver = exports.createSharedResizeObserver = void 0;

var _resizeObserver = require("@juggle/resize-observer");

var _nanoPubsub = _interopRequireDefault(require("nano-pubsub"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var ResizeObserver = window.ResizeObserver || _resizeObserver.ResizeObserver;

var createSharedResizeObserver = () => {
  var event = (0, _nanoPubsub.default)();
  var resizeObserver = new ResizeObserver(entries => event.publish(entries));
  return {
    observe: (element, observer, options) => {
      var unsubscribe = event.subscribe(entries => {
        var entry = entries.find(e => e.target === element);

        if (entry) {
          observer(entry);
        }
      });
      resizeObserver.observe(element, options);
      return () => {
        unsubscribe();
        resizeObserver.unobserve(element);
      };
    }
  };
};

exports.createSharedResizeObserver = createSharedResizeObserver;
var resizeObserver = createSharedResizeObserver();
exports.resizeObserver = resizeObserver;