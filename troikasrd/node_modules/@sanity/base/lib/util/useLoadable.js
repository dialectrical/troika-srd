"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useLoadable = useLoadable;
exports.asLoadable = asLoadable;

var _rxjs = require("rxjs");

var _reactRx = require("react-rx");

var _operators = require("rxjs/operators");

var LOADING_STATE = {
  isLoading: true,
  value: undefined,
  error: undefined
};

function useLoadable(observable$, initialValue) {
  var initial = typeof initialValue === 'undefined' ? LOADING_STATE : {
    isLoading: false,
    value: initialValue,
    error: undefined
  };
  return (0, _reactRx.useMemoObservable)(() => observable$.pipe(asLoadable()), [observable$], initial);
}

function asLoadable() {
  return input$ => input$.pipe((0, _operators.map)(val => ({
    isLoading: false,
    value: val,
    error: undefined
  })), (0, _operators.catchError)(error => (0, _rxjs.of)({
    isLoading: false,
    value: undefined,
    error
  })));
}