"use strict";function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function e(t){return(e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function o(t,e,i){return(o=n()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var i=new(Function.bind.apply(t,o));return n&&r(i,n.prototype),i}).apply(null,arguments)}function i(t){var n="function"==typeof Map?new Map:void 0;return(i=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,i)}function i(){return o(t,arguments,e(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),r(i,t)})(t)}Object.defineProperty(exports,"__esModule",{value:!0});var s=Object.freeze({left:0,top:0,bottom:0,right:0}),a=Object.freeze({x:.5,y:.5,height:1,width:1}),u=function(){return t({},s)},f=function(){return t({},a)},p=function(t){var e,r;function n(e,r){var n;return void 0===r&&(r="Failed to resolve asset ID from source"),(n=t.call(this,r)||this).unresolvable=!0,n.input=e,n}return r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,n}(i(Error));function c(t){return Boolean(t.unresolvable&&"input"in t)}function l(t){return function(){try{return t.apply(void 0,arguments)}catch(t){if(c(t))return;throw t}}}var d="https://cdn.sanity.io",h=/^([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+\.[a-z0-9]+$/,x=/^file-[a-zA-Z0-9_]+-[a-z0-9]+$/,g=/^([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})-\d+x\d+\.[a-z0-9]+$/,m=/^image-[a-zA-Z0-9_]+-\d+x\d+-[a-z0-9]+$/,y=/^(?:images|files)\/([a-z0-9]+)\/([a-z0-9][-\w]*)\//,v=/^(?:image-[a-zA-Z0-9_]+-\d+x\d+-[a-z0-9]+|file-[a-zA-Z0-9_]+-[a-z0-9]+)$/,w={projectId:"a",dataset:"b"};function b(t){return j(t)&&"string"==typeof t._ref}function I(t){return j(t)&&"string"==typeof t._id}function A(t){return j(t)&&"string"==typeof t.path}function F(t){return j(t)&&"string"==typeof t.url}function _(t){var e=t;return j(e)&&e.asset&&"object"==typeof e.asset}function j(t){return null!==t&&!Array.isArray(t)&&"object"==typeof t}function O(t,e){if(!e)throw new Error("Project details (projectId and dataset) required to resolve path for image");var r=t.metadata.dimensions,n=t.vanityFilename||t.originalFilename;return"images/"+e.projectId+"/"+e.dataset+"/"+t.assetId+"-"+r.width+"x"+r.height+"."+t.extension+(n?"/"+n:"")}function z(t,e){return d+"/"+O(t,e)}function P(t,e){if(!e)throw new Error("Project details (projectId and dataset) required to resolve path for file");var r=t.vanityFilename||t.originalFilename;return"files/"+e.projectId+"/"+e.dataset+"/"+t.assetId+"."+t.extension+(r?"/"+r:"")}function D(t,e){return d+"/"+P(t,e)}function E(t){return _(t)?E(t.asset):b(t)?void 0:"string"==typeof t?y.test(G(t)||"")?S(t):void 0:A(t)?t.path:F(t)?S(t.url):void 0}function S(t){if(y.test(t))return t;if(!t.startsWith(d+"/"))throw new p('Failed to resolve path from URL "'+t+'"');var e=t.indexOf("?");return t.slice(d.length+1,-1===e?void 0:e)}var G=l(S);function R(t){var e=(G(t)||t).replace(/^(images|files)\/[a-z0-9]+\/[a-z0-9][-\w]\/*/,"");if(!$(e))throw new p('Failed to resolve filename from URL "'+t+'"');return e}var U=l(R);function $(t){return h.test(t)||g.test(t)}function Z(t){if(m.test(t))return T(t);if(x.test(t))return M(t);throw new Error("Invalid image/file asset ID: "+t)}function M(t){if(!x.test(t))throw new Error("Malformed file asset ID '"+t+'\'. Expected an id like "file-027401f31c3ac1e6d78c5d539ccd1beff72b9b11-pdf"');var e=t.split("-");return{type:"file",assetId:e[1],extension:e[2]}}function T(t){var e=t.split("-"),r=e[1],n=e[2],o=e[3],i=(n||"").split("x").map(Number),s=i[0],a=i[1];if(!(r&&n&&o&&s>0&&a>0))throw new Error("Malformed asset ID '"+t+'\'. Expected an id like "image-027401f31c3ac1e6d78c5d539ccd1beff72b9b11-2000x3000-jpg".');return{type:"image",assetId:r,width:s,height:a,extension:o}}function L(t){var e=T(X(t)),r=e.width,n=e.height;return{width:r,height:n,aspectRatio:r/n}}var C=l(L);function H(t){return at(t)?V(t,w).asset.extension:k(t,w).asset.extension}var W=l(H);function k(t,e){var r=t;return{asset:B(t,e||ot(t)),crop:r.crop||u(),hotspot:r.hotspot||f()}}var q=l(k);function B(e,r){var n=r||nt(e),o=X(e),i=(e.asset||e).metadata||{},s=T(o),a=s.width,u=s.height,f={_id:o,_type:"sanity.imageAsset",assetId:s.assetId,extension:s.extension,metadata:t({},i,{dimensions:{width:a,height:u,aspectRatio:a/u}}),url:"",path:""};return t({},f,{path:O(f,n),url:z(f,n)})}var N=l(B);function V(t,e){return{asset:K(t,e||ot(t))}}var J=l(V);function K(e,r){var n=r||nt(e),o=X(e),i=e.asset||e,s=M(o),a={_id:o,_type:"sanity.fileAsset",assetId:s.assetId,extension:s.extension,metadata:i.metadata||{},url:"",path:""};return t({},a,{path:P(a,n),url:D(a,n)})}var Q=l(K);function X(t){var e=_(t)?t.asset:t,r="";if("string"==typeof e?r=tt(e):b(e)?r=e._ref:I(e)?r=e._id:A(e)?r=rt(d+"/"+e.path):F(e)&&(r=rt(e.url)),!r||!v.test(r))throw new p(t);return r}var Y=l(X);function tt(t){if(v.test(t))return t;if(0===t.indexOf(d+"/images")||0===t.indexOf(d+"/files"))return rt(t);if(y.test(t))return rt(d+"/"+t);if(st(t))return rt(d+"/files/a/b/"+t);if(it(t))return rt(d+"/images/a/b/"+t);throw new p(t)}var et=l(tt);function rt(t){var e=S(t).split("/"),r=e[3];return e[0].replace(/s$/,"")+"-"+r.replace(/\./g,"-")}function nt(t){var e=E(t);if(!e)throw new p(t,"Failed to resolve project ID and dataset from source");var r=e.match(y)||[],n=r[1],o=r[2];if(!n||!o)throw new p(t,"Failed to resolve project ID and dataset from source");return{projectId:n,dataset:o}}var ot=l(nt);function it(t){return g.test(t)}function st(t){return h.test(t)}function at(t){return X(t).startsWith("file-")}exports.DEFAULT_CROP=s,exports.DEFAULT_HOTSPOT=a,exports.buildFilePath=P,exports.buildFileUrl=D,exports.buildImagePath=O,exports.buildImageUrl=z,exports.getAssetDocumentId=X,exports.getDefaultCrop=u,exports.getDefaultHotspot=f,exports.getExtension=H,exports.getFile=V,exports.getFileAsset=K,exports.getIdFromString=tt,exports.getImage=k,exports.getImageAsset=B,exports.getImageDimensions=L,exports.getProject=nt,exports.getUrlFilename=R,exports.getUrlPath=S,exports.isAssetFilename=function(t){return it(t)||st(t)},exports.isAssetIdStub=I,exports.isAssetObjectStub=_,exports.isAssetPathStub=A,exports.isAssetUrlStub=F,exports.isDefaultCrop=function(t){return t.top===s.top&&t.bottom===s.bottom&&t.left===s.left&&t.right===s.right},exports.isDefaultHotspot=function(t){return t.x===a.x&&t.y===a.y&&t.width===a.width&&t.height===a.height},exports.isFileAssetFilename=st,exports.isFileSource=at,exports.isImageAssetFilename=it,exports.isImageSource=function(t){return X(t).startsWith("image-")},exports.isObject=j,exports.isReference=b,exports.isSanityFileAsset=function(t){return j(t)&&"sanity.fileAsset"===t._type},exports.isValidFilename=$,exports.parseAssetFilename=function(t){var e=U(t)||"";if(!$(e))throw new Error("Invalid image/file asset filename: "+t);try{return Z((g.test(e)?"image":"file")+"-"+e.replace(/\.([a-z0-9+]+)$/i,"-$1"))}catch(e){throw new Error("Invalid image/file asset filename: "+t)}},exports.parseAssetId=Z,exports.parseFileAssetId=M,exports.parseImageAssetId=T,exports.tryGetAssetDocumentId=Y,exports.tryGetAssetPath=E,exports.tryGetExtension=W,exports.tryGetFile=J,exports.tryGetFileAsset=Q,exports.tryGetIdFromString=et,exports.tryGetImage=q,exports.tryGetImageAsset=N,exports.tryGetImageDimensions=C,exports.tryGetProject=ot,exports.tryGetUrlFilename=U,exports.tryGetUrlPath=G;
//# sourceMappingURL=asset-utils.cjs.production.min.js.map
