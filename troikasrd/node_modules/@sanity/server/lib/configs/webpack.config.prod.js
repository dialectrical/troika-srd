"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _webpack = _interopRequireDefault(require("webpack"));

var _webpack2 = _interopRequireDefault(require("./webpack.config"));

var _applyLocalWebpackConfig = require("./applyLocalWebpackConfig");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var _default = config => {
  var basePath = config.basePath || process.cwd();
  var baseConfig = (0, _webpack2.default)(Object.assign({}, config, {
    env: 'production'
  }));
  var prodConfig = Object.assign({}, baseConfig, {
    devtool: config.sourceMaps ? 'source-map' : undefined,
    plugins: (baseConfig.plugins || []).concat([new _webpack.default.DefinePlugin({
      'process.env.NODE_ENV': JSON.stringify('production')
    })].filter(Boolean))
  });
  return (0, _applyLocalWebpackConfig.applyLocalWebpackConfig)(prodConfig, basePath, 'production');
};

exports.default = _default;