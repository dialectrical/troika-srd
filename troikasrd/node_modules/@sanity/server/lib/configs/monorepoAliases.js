"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getMonorepoAliases = getMonorepoAliases;

var _path = _interopRequireDefault(require("path"));

var _fs = _interopRequireDefault(require("fs"));

var _json = _interopRequireDefault(require("json5"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var MONOREPO_PATH = _path.default.resolve(__dirname, '../../../../..');

var ALIASES_FILENAME = "".concat(MONOREPO_PATH, "/.webpack-aliases.json5");

function resolve() {
  for (var _len = arguments.length, segments = new Array(_len), _key = 0; _key < _len; _key++) {
    segments[_key] = arguments[_key];
  }

  return _path.default.resolve(MONOREPO_PATH, ...segments);
}

function getMonorepoAliases() {
  var defaultAliases = {
    '@sanity/ui': require.resolve('@sanity/ui'),
    'styled-components': require.resolve('styled-components')
  };
  var aliasesContents = '';

  try {
    aliasesContents = _fs.default.readFileSync(ALIASES_FILENAME, 'utf-8');
  } catch (err) {
    // eslint-disable-next-line no-console
    console.warn('WARNING: No path aliases found in `%s`', ALIASES_FILENAME, err.message);
  }

  var aliases = aliasesContents ? _json.default.parse(aliasesContents) : defaultAliases;
  var all = Object.keys(aliases).reduce((acc, key, obj) => {
    acc[key] = resolve(aliases[key]);
    return acc;
  }, {});
  return all;
}